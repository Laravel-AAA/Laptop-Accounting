import{j as t,R as p,q as m,r as d,y as x}from"./app-c4f99fcf.js";import h from"./AccountRow-4ab7a6c7.js";import{T as b}from"./TemplateModal-887ac09f.js";import{I as c}from"./Input-1445c9c1.js";import{r as j}from"./index-f2ce906e.js";import{S as f}from"./SelectInput-68e81406.js";import{P as u}from"./PrimaryMaterialBtn-246466d8.js";import{S as g}from"./SecondaryMaterialBtn-b53c04d3.js";import{u as y}from"./useBetterForm-099c9197.js";import{a as v}from"./index.esm-08f6393a.js";import{A as w}from"./AlertModal-da0fdba1.js";import"./FromDate-d39d25ed.js";import"./AccountOptions-bd2bec77.js";import"./Dropdown-dfe61cef.js";import"./BetterLink-8982a3f8.js";import"./transition-002ab40b.js";import"./index.esm-068ae3e8.js";import"./iconBase-adc01455.js";import"./index.esm-ca4caddf.js";import"./ErrorMessage-bb2e37f7.js";import"./index-ab3f0488.js";function C({form:e}){return t.jsx(f,{label:"Role",value:e.data.role,errorMsg:e.errors.role,hideError:e.isDirty("role"),onChange:s=>e.setData("role",s??"Cashier"),disabled:e.processing,required:!0,selected:s=>s&&p.cloneElement(s,{disabled:!0,className:"flex items-center opacity-100 px-0 gap-2 group pointer-events-none"}),children:N.map(s=>t.jsxs(j.Option,{value:s.name,className:"flex flex-col gap-1",children:[s.name,t.jsx("span",{className:"text-xs text-blue-gray-300 group-[]:hidden",children:s.desc})]},s.name))})}const N=[{name:"Cashier",desc:"Can perform checkout. Can edit or delete only the bills that they have created themselves."},{name:"Maintainer",desc:"Can perform checkout. Can manage all bills and inventory."},{name:"Owner",desc:"Have all Maintainer privileges. And manage accounts and business information."}];function E({form:e,modalAction:s}){return t.jsxs("div",{className:"space-y-4",children:[t.jsx(c,{id:"name",label:"Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:s.state==="show"||e.processing,onChange:a=>e.setData("name",a.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")}),t.jsx(c,{label:"Email",type:"email",inputMode:"email",autoComplete:"off",value:e.data.email,className:"mt-1 block w-full",disabled:e.processing,onChange:a=>{e.setData("email",a.target.value)},errorMsg:e.errors.email,hideError:e.isDirty("email"),required:!0,hint:t.jsxs(t.Fragment,{children:[s.state==="create"&&t.jsx("span",{children:"A verification link will be sent to this email"}),s.state==="edit"&&t.jsx("span",{children:"Note: If you change the email address, the account owner will need to re-verify the new email address."})]})}),s.state==="create"&&t.jsx(c,{label:"Initial Password",type:"password",name:"password",value:e.data.password,errorMsg:e.errors.password,hideError:e.isDirty("password"),disabled:e.processing,className:"mt-1 block w-full",autoComplete:"new-password",onChange:a=>{e.setData("password",a.target.value)},required:!0}),t.jsx(C,{form:e})]})}function M({modalAction:e,setModalAction:s,form:a}){return t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[t.jsx(u,{type:"submit",disabled:a.processing,children:e.state==="create"?"Create":"Save"}),t.jsx(g,{type:"button",onClick:()=>{a.cancel(),s(r=>({...r,open:!1})),a.reset(),a.clearErrors()},children:"Cancel"})]})}function D({modalAction:e,setModalAction:s}){const a=m().props.auth.user.business_id,r=y(e.state==="create"?{name:"",email:"",password:"",password_confirmation:"",role:"Cashier",business_id:a}:{...e.data},e.data?e.data.id.toString():"create");function l(n){n.preventDefault();const i={onSuccess:()=>{r.clearErrors(),r.reset(),s(()=>({state:"create",data:null,open:!1}))}};e.state==="create"?r.post(route("account.store"),i):r.patch(route("account.update",e.data.id),i)}return t.jsxs("form",{className:"mt-3",onSubmit:l,children:[t.jsx(E,{form:r,modalAction:e}),t.jsx(M,{modalAction:e,setModalAction:s,form:r})]})}function S({modalAction:e,setModalAction:s}){return t.jsx(b,{title:k(e.state),open:e.open,closeModal:()=>s(a=>({...a,open:!1})),children:t.jsx(D,{modalAction:e,setModalAction:s})})}function k(e){return e==="create"?"Create New Account":"Edit Account"}function q({account:e,isOpen:s,requestClose:a}){const[r,l]=d.useState(!1);return t.jsx(w,{icon:"danger",title:"Are you sure?",paragraph:t.jsxs("span",{children:["You are about to permanently delete"," ",t.jsx("span",{className:"font-semibold text-gray-600",children:e==null?void 0:e.name})," ","account?"]}),buttons:[{type:"danger",text:"Delete",props:{onClick:()=>{l(!0),x.delete(route("account.forceDestroy",e==null?void 0:e.id),{preserveScroll:!0,preserveState:!0,onFinish:()=>l(!1),onError:n=>{n.serverError&&alert(n.serverError)}})},disabled:r}},{type:"secondary",text:"Cancel"}],isOpen:s,requestClose:n=>a(n)})}function Z({business:e}){const[s,a]=d.useState({state:"create",open:!1,data:null}),[r,l]=d.useState({open:!1});return t.jsxs("section",{className:"bg-white p-4 pb-0 shadow sm:rounded-lg sm:p-8 sm:pb-0",children:[t.jsx(S,{modalAction:s,setModalAction:a},"businessAccountsTableCreateEditAccount"),t.jsxs("header",{children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Accounts"}),t.jsxs("div",{className:"flex",children:[t.jsx("p",{className:"text-normal mt-1 grow text-gray-600",children:"Add, remove, or edit an account in your business."}),t.jsxs(u,{className:"!mx-2 flex gap-2 xl:!mr-10 ",onClick:()=>a({open:!0,state:"create",data:null}),children:[t.jsx(v,{className:"w-4"}),"Create New Account"]})]})]}),t.jsx("div",{className:"mt-6 space-y-6",children:t.jsx("div",{children:t.jsx("div",{className:"mx-auto w-full overflow-x-auto overflow-y-hidden pb-28 xl:px-10 ",children:t.jsx("div",{className:"min-w-fit rounded-md border",children:t.jsxs("table",{className:"w-full table-auto  text-left",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx(o,{className:"rounded-tl-md",children:"Name"}),t.jsx(o,{children:"Email"}),t.jsx(o,{children:"Role"}),t.jsx(o,{title:"Only verified accounts can access the system",children:"State"}),t.jsx(o,{title:"Created date",children:"Date"}),t.jsx(o,{title:"Account options",className:"rounded-tr-md "})]})}),t.jsx("tbody",{children:e.users.map(n=>t.jsx(h,{account:n,requestOpenDeleteModal:i=>l({open:!0,account:i}),requestEdit:()=>a(()=>({state:"edit",data:n,open:!0}))},n.id))})]})})})})}),t.jsx(q,{account:r.account,isOpen:r.open,requestClose:()=>l(n=>({...n,open:!1}))},"businessAccountsTablePermanentDeleteConfirmAccountModal")]})}function o({className:e="",children:s,...a}){return t.jsx("th",{...a,className:"min-w-fit border-b border-blue-gray-100 bg-blue-gray-50 p-4 "+e,children:t.jsx("p",{className:"text-sm font-semibold leading-none tracking-wide text-black opacity-90",children:s})})}export{Z as default};
