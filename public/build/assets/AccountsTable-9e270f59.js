import{j as e,R as x,r as d,q as h,y as j}from"./app-597d038e.js";import g from"./AccountRow-00f31a96.js";import{T as b}from"./TemplateModal-aa8f79b5.js";import{I as c}from"./Input-568c2f70.js";import{r as f}from"./index-1f12a61e.js";import{S as y}from"./SelectInput-9ca3e419.js";import{P as u}from"./PrimaryButton-b02ed71d.js";import{S as m}from"./SecondaryButton-0005ea90.js";import{u as v}from"./useBetterForm-1e02708f.js";import{F as w}from"./index.esm-d6f9327b.js";import{A as C}from"./AlertModal-8e80492c.js";import"./FromDate-6f3269dd.js";import"./AccountOptions-ace396cf.js";import"./Dropdown-7d7d7dcf.js";import"./transition-3e3ca368.js";import"./index.esm-c698fa55.js";import"./iconBase-a121196f.js";import"./index.esm-0757006a.js";import"./DangerButton-a14afe1f.js";import"./ErrorMessage-59b540d3.js";import"./index-9d7526b5.js";function N({form:t}){return e.jsx(y,{label:"Role",id:"role",name:"role",value:t.data.role,errorMsg:t.errors.role,hideError:t.isDirty("role"),onChange:s=>t.setData("role",s??"Cashier"),disabled:t.processing,required:!0,selected:s=>s&&x.cloneElement(s,{disabled:!0,className:"flex items-center opacity-100 px-0 gap-2 group pointer-events-none"}),children:E.map(s=>e.jsxs(f.Option,{value:s.name,className:"flex flex-col gap-1",children:[s.name,e.jsx("span",{className:"text-xs text-blue-gray-300 group-[]:hidden",children:s.desc})]},s.name))})}const E=[{name:"Cashier",desc:"Can perform checkout. Can edit or delete only the bills that they have created themselves."},{name:"Maintainer",desc:"Can perform checkout. Can manage all bills and inventory."},{name:"Owner",desc:"Have all Maintainer privileges. And manage business information and accounts."}];function S({form:t,modalAction:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{id:"name",label:"Name",name:"name",type:"text",value:t.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:s.state==="show"||t.processing,onChange:a=>t.setData("name",a.target.value),required:!0,errorMsg:t.errors.name,hideError:t.isDirty("name")}),e.jsx(c,{label:"Email",type:"email",inputMode:"email",autoComplete:"off",value:t.data.email,className:"mt-1 block w-full",disabled:t.processing,onChange:a=>{t.setData("email",a.target.value)},errorMsg:t.errors.email,hideError:t.isDirty("email"),required:!0,hint:e.jsxs(e.Fragment,{children:[s.state==="create"&&e.jsx("span",{children:"A verification link will be sent to this email"}),s.state==="edit"&&e.jsx("span",{children:"Note: If you change the email address, the account owner will need to re-verify the new email address."})]})}),s.state==="create"&&e.jsx(c,{label:"Initial Password",type:"password",name:"password",value:t.data.password,errorMsg:t.errors.password,hideError:t.isDirty("password"),disabled:t.processing,className:"mt-1 block w-full",autoComplete:"new-password",onChange:a=>{t.setData("password",a.target.value)},required:!0}),e.jsx(N,{form:t})]})}function D({modalAction:t,setModalAction:s,form:a}){return d.useState(!1),e.jsx("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:t.state==="create"?e.jsxs(e.Fragment,{children:[e.jsx(u,{type:"submit",disabled:a.processing,children:"Create"}),e.jsx(p,{setModalAction:s,form:a})]}):t.state==="edit"?e.jsxs(e.Fragment,{children:[e.jsx(u,{type:"submit",disabled:a.processing,children:"Save"}),e.jsx(p,{setModalAction:s,form:a})]}):e.jsx(e.Fragment,{})})}function p({setModalAction:t,form:s}){return e.jsx(m,{type:"button",onClick:()=>{s.cancel(),t(a=>({...a,open:!1})),s.reset(),s.clearErrors()},children:"Cancel"})}function M({modalAction:t,setModalAction:s}){const a=h().props.auth.user.business_id,n=v(t.state==="create"?{name:"",email:"",password:"",password_confirmation:"",role:"Cashier",business_id:a}:{...t.data},t.data?t.data.id.toString():"create");function l(r){r.preventDefault();const o={onSuccess:()=>{n.clearErrors(),n.reset(),s(()=>({state:"create",data:null,open:!1}))}};t.state==="create"?n.post(route("account.store"),o):n.patch(route("account.update",t.data.id),o)}return e.jsxs("form",{className:"mt-3",onSubmit:l,children:[e.jsx(S,{form:n,modalAction:t}),e.jsx(D,{modalAction:t,setModalAction:s,form:n})]})}function F({modalAction:t,setModalAction:s}){return e.jsx(b,{title:k(t.state),open:t.open,closeModal:()=>s(a=>({...a,open:!1})),children:e.jsx(M,{modalAction:t,setModalAction:s})})}function k(t){return t==="create"?"Create New Account":"Edit Account"}function q({account:t,isOpen:s,requestClose:a}){const[n,l]=d.useState(!1);return e.jsx(C,{icon:"danger",title:"Are you sure?",paragraph:e.jsxs("span",{children:["You are about to permanently delete"," ",e.jsx("span",{className:"font-semibold text-gray-600",children:t==null?void 0:t.name})," ","account?"]}),buttons:{danger:{text:"Delete",props:{onClick:()=>{l(!0),j.delete(route("account.forceDestroy",t==null?void 0:t.id),{preserveScroll:!0,preserveState:!0,onFinish:()=>l(!1),onError:r=>{r.serverError&&alert(r.serverError)}})},disabled:n}},secondary:{text:"Cancel"}},isOpen:s,requestClose:r=>a(r)})}function $({business:t}){const[s,a]=d.useState({state:"create",open:!1,data:null}),[n,l]=d.useState({open:!1});return e.jsxs("section",{className:"bg-white p-4 pb-0 shadow sm:rounded-lg sm:p-8 sm:pb-0",children:[e.jsx(F,{modalAction:s,setModalAction:a}),e.jsxs("header",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Accounts"}),e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"text-normal mt-1 grow text-gray-600",children:"Add, remove, or edit an account in your business."}),e.jsxs(m,{className:"!mx-2 flex gap-2 xl:!mr-10 ",onClick:()=>a({open:!0,state:"create",data:null}),children:[e.jsx(w,{className:"w-4"}),"Create New Account"]})]})]}),e.jsx("div",{className:"mt-6 space-y-6",children:e.jsx("div",{children:e.jsx("div",{className:"mx-auto w-full overflow-x-auto overflow-y-hidden pb-28 xl:px-10 ",children:e.jsx("div",{className:"min-w-fit rounded-md border",children:e.jsxs("table",{className:"w-full table-auto  text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(i,{className:"rounded-tl-md",children:"Name"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Role"}),e.jsx(i,{title:"Only verified accounts can access the system",children:"State"}),e.jsx(i,{title:"Created date",children:"Date"}),e.jsx(i,{title:"Account options",className:"rounded-tr-md "})]})}),e.jsx("tbody",{children:t.users.map(r=>e.jsx(g,{account:r,requestOpenDeleteModal:o=>l({open:!0,account:o}),requestEdit:()=>a(()=>({state:"edit",data:r,open:!0}))},r.id))})]})})})})}),e.jsx(q,{account:n.account,isOpen:n.open,requestClose:()=>l(r=>({...r,open:!1}))})]})}function i({className:t="",children:s,...a}){return e.jsx("th",{...a,className:"min-w-fit border-b border-blue-gray-100 bg-blue-gray-50 p-4 "+t,children:e.jsx("p",{className:"text-sm font-semibold leading-none tracking-wide text-black opacity-90",children:s})})}export{$ as default};
