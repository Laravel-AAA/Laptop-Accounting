import{j as t,R as x,q as h,r as u,y as b}from"./app-b733aa80.js";import f from"./AccountRow-839a92d2.js";import{T as j}from"./TemplateModal-1a00ecdb.js";import{I as d}from"./Input-f31a5d66.js";import{r as g}from"./index-6016834e.js";import{S as y}from"./SelectInput-c9cd0231.js";import{u as c}from"./useTranslation-c33630a8.js";import{P as p}from"./PrimaryMaterialBtn-2093adc3.js";import{S as v}from"./SecondaryMaterialBtn-e8480018.js";import{u as w}from"./useBetterForm-fe81747f.js";import{a as C}from"./index-9ca673dc.js";import{A as N}from"./AlertModal-71b3ab3b.js";import"./FromDate-4e94fd30.js";import"./AccountOptions-09c4fd1f.js";import"./Dropdown-1840d60d.js";import"./BetterLink-91206f94.js";import"./transition-177ebb00.js";import"./index-f0312942.js";import"./iconBase-e5c9f32e.js";import"./index-84652058.js";import"./ErrorMessage-42f308db.js";import"./index-c9736f8d.js";function E({form:e}){return t.jsx(y,{label:"Role",value:e.data.role,errorMsg:e.errors.role,hideError:e.isDirty("role"),onChange:s=>e.setData("role",s??"Cashier"),disabled:e.processing,required:!0,selected:s=>s&&x.cloneElement(s,{disabled:!0,className:"flex items-center opacity-100 px-0 gap-2 group pointer-events-none"}),children:M.map(s=>t.jsxs(g.Option,{value:s.name,className:"flex flex-col gap-1",children:[s.name,t.jsx("span",{className:"text-xs text-blue-gray-300 group-[]:hidden",children:s.desc})]},s.name))})}const M=[{name:"Cashier",desc:"Can perform checkout. Can edit or delete only the bills that they have created themselves."},{name:"Maintainer",desc:"Can perform checkout. Can manage all bills and inventory."},{name:"Owner",desc:"Have all Maintainer privileges. And manage accounts and business information."}];function S({form:e,modalAction:s}){const{t:r}=c();return t.jsxs("div",{className:"space-y-4",children:[t.jsx(d,{id:"name",label:"Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:s.state==="show"||e.processing,onChange:a=>e.setData("name",a.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")}),t.jsx(d,{label:"Email",type:"email",inputMode:"email",autoComplete:"off",value:e.data.email,className:"mt-1 block w-full",disabled:e.processing,onChange:a=>{e.setData("email",a.target.value)},errorMsg:e.errors.email,hideError:e.isDirty("email"),required:!0,hint:t.jsxs(t.Fragment,{children:[s.state==="create"&&t.jsx("span",{children:r("A verification link will be sent to this email")}),s.state==="edit"&&t.jsx("span",{children:r("Note: If you change the email address, the account owner will need to re-verify the new email address.")})]})}),s.state==="create"&&t.jsx(d,{label:"Initial Password",type:"password",name:"password",value:e.data.password,errorMsg:e.errors.password,hideError:e.isDirty("password"),disabled:e.processing,className:"mt-1 block w-full",autoComplete:"new-password",onChange:a=>{e.setData("password",a.target.value)},required:!0}),t.jsx(E,{form:e})]})}function D({modalAction:e,setModalAction:s,form:r}){const{t:a}=c();return t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[t.jsx(p,{type:"submit",disabled:r.processing,children:a(e.state==="create"?"Create":"Save")}),t.jsx(v,{type:"button",onClick:()=>{r.cancel(),s(o=>({...o,open:!1})),r.reset(),r.clearErrors()},children:a("Cancel")})]})}function k({modalAction:e,setModalAction:s}){const r=h().props.auth.user.business_id,a=w(e.state==="create"?{name:"",email:"",password:"",password_confirmation:"",role:"Cashier",business_id:r}:{...e.data},e.data?e.data.id.toString():"create");function o(n){n.preventDefault();const l={onSuccess:()=>{a.clearErrors(),a.reset(),s(()=>({state:"create",data:null,open:!1}))}};e.state==="create"?a.post(route("account.store"),l):a.patch(route("account.update",e.data.id),l)}return t.jsxs("form",{className:"mt-3",onSubmit:o,children:[t.jsx(S,{form:a,modalAction:e}),t.jsx(D,{modalAction:e,setModalAction:s,form:a})]})}function q({modalAction:e,setModalAction:s}){return t.jsx(j,{title:A(e.state),open:e.open,closeModal:()=>s(r=>({...r,open:!1})),children:t.jsx(k,{modalAction:e,setModalAction:s})})}function A(e){return e==="create"?"Create New Account":"Edit Account"}function F({account:e,isOpen:s,requestClose:r}){const[a,o]=u.useState(!1),{t:n}=c();return t.jsx(N,{icon:"danger",title:"Are you sure?",paragraph:t.jsxs("span",{children:[n("You are about to permanently delete")," ",t.jsx("span",{className:"font-semibold text-gray-600",children:e==null?void 0:e.name})," ",n("account?")]}),buttons:[{type:"danger",text:"Delete",props:{onClick:()=>{o(!0),b.delete(route("account.forceDestroy",e==null?void 0:e.id),{preserveScroll:!0,preserveState:!0,onFinish:()=>o(!1),onError:l=>{l.serverError&&alert(l.serverError)}})},disabled:a}},{type:"secondary",text:"Cancel"}],isOpen:s,requestClose:l=>r(l)})}function te({business:e}){const[s,r]=u.useState({state:"create",open:!1,data:null}),[a,o]=u.useState({open:!1}),{t:n}=c();return t.jsxs("section",{className:"bg-white p-4 pb-0 shadow sm:rounded-lg sm:p-8 sm:pb-0",children:[t.jsx(q,{modalAction:s,setModalAction:r},"businessAccountsTableCreateEditAccount"),t.jsxs("header",{children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Accounts"}),t.jsxs("div",{className:"flex",children:[t.jsx("p",{className:"text-normal mt-1 grow text-gray-600",children:n("Add, remove, or edit an account in your business.")}),t.jsxs(p,{className:"!mx-2 flex gap-2 xl:!mr-10 ",onClick:()=>r({open:!0,state:"create",data:null}),children:[t.jsx(C,{className:"w-4"}),n("Create New Account")]})]})]}),t.jsx("div",{className:"mt-6 space-y-6",children:t.jsx("div",{children:t.jsx("div",{className:"mx-auto w-full overflow-x-auto overflow-y-hidden pb-28 xl:px-10 ",children:t.jsx("div",{className:"min-w-fit rounded-md border",children:t.jsxs("table",{className:"w-full table-auto  text-left",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx(i,{className:"rounded-tl-md",children:n("Name")}),t.jsx(i,{children:n("Email")}),t.jsx(i,{children:n("Role")}),t.jsx(i,{title:n("Only verified accounts can access the system"),children:n("State")}),t.jsx(i,{title:n("Created date"),children:n("Date")}),t.jsx(i,{title:n("Account options"),className:"rounded-tr-md "})]})}),t.jsx("tbody",{children:e.users.map(l=>t.jsx(f,{account:l,requestOpenDeleteModal:m=>o({open:!0,account:m}),requestEdit:()=>r(()=>({state:"edit",data:l,open:!0}))},l.id))})]})})})})}),t.jsx(F,{account:a.account,isOpen:a.open,requestClose:()=>o(l=>({...l,open:!1}))},"businessAccountsTablePermanentDeleteConfirmAccountModal")]})}function i({className:e="",children:s,...r}){return t.jsx("th",{...r,className:"min-w-fit border-b border-blue-gray-100 bg-blue-gray-50 p-4 "+e,children:t.jsx("p",{className:"text-sm font-semibold leading-none tracking-wide text-black opacity-90",children:s})})}export{te as default};
