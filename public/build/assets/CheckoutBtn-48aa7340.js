import{r,q as h,j as t}from"./app-93f448e9.js";import{S as d}from"./SecondaryButton-3ada0a47.js";import{T as p}from"./TemplateModal-b6fba451.js";import{P as x}from"./PrimaryButton-0038024a.js";import{C as g}from"./Checkbox-060d434e.js";import{I as v}from"./InputError-6d6f313c.js";import{I as b}from"./InputHint-87040951.js";import{I as j}from"./InputLabel-1efa94fb.js";import{T as N}from"./TextInput-b5a087a8.js";import y from"./TotalInfo-f4cf95f5.js";import{N as R}from"./Num-70d08095.js";import"./DangerButton-2f8cfe40.js";import"./transition-73953e81.js";function f({form:e}){const[a,s]=r.useState(!1),[o,n]=r.useState(0),u=h().props.business.taxPercent;function m(){return e.data.transactions.reduce((c,i)=>(i.product.price??0)*i.quantity+c,0)}function l(){return m()*(1+u)}return r.useEffect(()=>{e.data.cashReceived!==null&&typeof e.data.id=="string"?n((e.data.cashReceived??0)-l()):e.setData("cashReceived",Number(l().toFixed(2)))},[]),t.jsxs(t.Fragment,{children:[t.jsx(y,{bill:e.data}),t.jsxs("div",{className:"mt-3 w-full",children:[t.jsx(j,{htmlFor:"cashReceived",value:"Cash Received"}),t.jsx(N,{id:"cashReceived",name:"cashReceived",type:"number",value:e.data.cashReceived===null?"":Number(e.data.cashReceived.toFixed(2)),className:"mt-1 block w-full text-xl",inputMode:"numeric",isFocused:!0,isSelect:!0,onClick:c=>c.currentTarget.select(),disabled:e.processing||a,onChange:c=>{const i=Number(c.target.value);e.setData("cashReceived",i),n(Number(Number((i??0)-l()).toFixed(2)))}}),t.jsx(v,{message:e.errors.cashReceived,className:"mt-2"}),t.jsx(b,{children:t.jsxs("p",{style:{visibility:a?"hidden":"visible"},className:"ml-2 mt-1 text-lg text-gray-800",children:["Remaining:Â ",t.jsx(R,{currency:"$",className:"text-indigo-700",amount:o})]})}),t.jsxs("label",{className:"ml-2 mt-2 flex items-center",children:[t.jsx(g,{name:"isDigitalPayment",className:"h-5 w-5",checked:a,disabled:e.processing,onChange:c=>{s(i=>(a?(e.data.id===void 0&&e.setData("cashReceived",l()),n(0)):(e.data.id===void 0&&e.setData("cashReceived",null),n((e.data.cashReceived??0)-l())),!i))}}),t.jsx("span",{className:"ml-2 text-lg text-gray-600",children:"Digital payment"})]})]})]})}function C({form:e,isShow:a,requestClose:s}){function o(n){n.preventDefault(),e.post(route("bill.store"),{onSuccess:()=>{s(),e.clearErrors(),e.reset()}})}return t.jsx(p,{title:"Checkout",open:a,closeModal:()=>s(),children:t.jsxs("form",{className:"mt-3",onSubmit:o,children:[t.jsx(f,{form:e}),t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[t.jsx(x,{type:"submit",disabled:e.processing,children:e.data.id===void 0?"Checkout":"Update"}),t.jsx(d,{type:"button",onClick:()=>{e.cancel(),s(),e.clearErrors()},children:"Cancel"})]})]})})}function z({form:e}){const[a,s]=r.useState(!1);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"pointer-events-none absolute bottom-[50px] h-5 w-full bg-gradient-to-t from-white to-transparent opacity-90"}),t.jsx("div",{className:"absolute bottom-0 w-full",children:t.jsx(d,{style:{fontSize:"1.2rem",fontWeight:800},className:"bottom-0  h-[50px] w-full min-w-full rounded-none",disabled:e.processing||e.data.transactions.length==0,title:e.processing||e.data.transactions.length==0?"You can't checkout with an empty cart!":"",onClick:()=>s(!0),children:e.data.id===void 0?"Checkout":"Update"})}),t.jsx(C,{isShow:a,requestClose:()=>s(!1),form:e})]})}export{z as default};
