import{r as m,j as t,q as N,a as I}from"./app-1c25774f.js";import{A as S}from"./index-366d1aaa.js";import F from"./Product-f61642fa.js";import{P as E}from"./Pagination-7f7adb97.js";import{B as M}from"./index.esm-cd9bbf79.js";import{I as p,H as f}from"./Input-39d53c15.js";import{D as q,S as T}from"./SecondaryMaterialBtn-184bd2fc.js";import{S as B}from"./SecondaryButton-8c6ebb39.js";import y from"./NoImageImage-c509f6a9.js";import{C as _}from"./Checkbox-f6673604.js";import{N as h}from"./Num-763d349f.js";import{r as w}from"./index-87120360.js";import{E as H}from"./ErrorMessage-4ccff6f2.js";import{D as L}from"./ProductOptions-9a098b3f.js";import{P as R}from"./PrimaryMaterialBtn-702e4d0a.js";import{u as V}from"./useBetterForm-7cf4420e.js";import{T as W}from"./TemplateModal-6d8aef30.js";import{F as v}from"./FromDate-d61fc7b4.js";import{K as c}from"./KeyValue-e9ed77e7.js";import{d as K,e as O}from"./index.esm-2fe96f96.js";import U from"./InventoryHeader-90e8087f.js";import{F as $}from"./Footer-9fd99687.js";import"./Logo-841e20e9.js";import"./Dropdown-c98de6ee.js";import"./transition-f1e823b0.js";import"./iconBase-338e10db.js";import"./index.esm-1f74e87a.js";import"./AlertModal-02ba5dd5.js";import"./index-d77bb9c5.js";import"./index-387d7a00.js";import"./usePrevious-05d0721d.js";import"./SupportEmailLink-48db2236.js";function z({formProps:e,modalAction:a}){const s=a.state,r=e.data.img,[i,n]=m.useState(()=>"default");return s==="create"?t.jsx(g,{img:r,state:s,editImageState:i,form:e}):s==="show"?r===null?t.jsx(y,{}):t.jsx(b,{img:r,productName:e.data.name}):r===null?t.jsx(g,{img:r,state:s,editImageState:i,form:e}):i==="default"?t.jsxs(t.Fragment,{children:[t.jsx(b,{img:r,productName:e.data.name}),t.jsxs("div",{className:"mb-4 mt-1 flex justify-center gap-8",children:[t.jsx(B,{disabled:e.processing,onClick:()=>{n("change")},children:"Change Image"}),t.jsx(q,{disabled:e.processing,onClick:()=>{n("removed"),e.setData("img",null)},children:"Remove Image"})]})]}):t.jsx(g,{img:r,state:s,editImageState:i,form:e})}function b({img:e,productName:a}){return t.jsx("div",{className:"mt-1  rounded-md border border-gray-300",children:t.jsx("img",{className:"mx-auto h-40",src:e!=null&&e.startsWith("http")?e:"products-images/"+e,alt:"Image "+(e??"")+" of product "+a})})}function g({img:e,state:a,editImageState:s,form:r}){return t.jsxs(t.Fragment,{children:[t.jsx(p,{label:(e===null&&a==="edit"||s==="removed"||a==="create"?"Choose ":s==="change"?"Change ":"")+"Image",type:"file",className:"mt-1 block w-full",accept:"image/*",hidden:!!e,disabled:a==="show"||r.processing,required:!1,onChange:i=>{var n;r.setData("imageFile",((n=i.target.files)==null?void 0:n[0])??null)},errorMsg:r.errors.img||r.errors.imageFile,hideError:r.isDirty("img")||r.isDirty("imageFile"),hint:"We recommend an image with white background"}),r.progress&&t.jsx("div",{className:"my-1 h-2.5 w-full rounded-md bg-gray-200 dark:bg-gray-700",children:t.jsx("div",{style:{width:r.progress+"%"},className:"h-2.5 rounded-md bg-green-600 dark:bg-green-500"})})]})}function G({color:e="teal",variant:a="outlined",size:s="lg",className:r="",errorMsg:i,errorMsgProps:n,hideError:d,error:o,hint:l,hintProps:u,label:x,disabled:j,required:C,autoComplete:ee="off",id:k=x.toLowerCase().replaceAll(/[^\w]/g,"-"),name:D=x.toLowerCase().replaceAll(/[^\w]/g,"-"),ref:te,...P}){return o===void 0&&(d===!0?o=!1:i?o=!0:o=!1),t.jsxs(t.Fragment,{children:[t.jsx(w.Textarea,{id:k,name:D,label:x,"aria-label":x,className:r+" focus:ring-0",variant:a,color:e,size:s,error:o,disabled:j,required:j===!0?!1:C,...P}),t.jsx(H,{message:i,...n}),typeof l=="string"?t.jsx(f,{message:l,...u}):t.jsx(f,{children:l})]})}function J({formProps:e,modalAction:a}){const[s,r]=m.useState(!1),[i,n]=m.useState(e.data.price),d=N().props.auth.business.taxPercent;function o(l){return l==null?l:Number(Number(l).toFixed(8))}return t.jsxs("div",{className:"",children:[t.jsx("div",{className:"w-full",children:t.jsx(p,{id:"name",label:"Product Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:a.state==="show"||e.processing,onChange:l=>e.setData("name",l.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(p,{id:"price",label:"Price",type:"number",inputMode:"decimal",autoComplete:"off",name:"price",value:i??void 0,className:"mt-1 block w-full",disabled:a.state==="show"||e.processing,onChange:l=>{const u=o(l.target.value);n(u),e.setData("price",o(s?(u??0)/(1+d):u))},errorMsg:e.errors.price,hideError:e.isDirty("price"),required:!1,hint:a.state==="edit"&&t.jsx("span",{children:"If you change the price of this product, it may affect the bills that have already been issued with the old price. This could result in incorrect calculations, such as the total price of a bill. Please make sure you have no bills that have this product."})}),t.jsx(_,{label:t.jsxs("span",{children:["Price includes tax (",t.jsx(h,{showCurrency:!0,amount:e.data.price??0})," without tax)"]}),checked:s,errorMsg:void 0,disabled:e.processing,onChange:l=>{r(u=>(e.setData("price",o(i!=null&&!u?i/(1+d):i)),!u))}})]}),t.jsx("div",{className:"mt-3",children:t.jsx(p,{id:"stock",label:"Stock",type:"number",name:"stock",value:e.data.stock??void 0,className:"mt-1 block w-full",disabled:a.state==="show"||e.processing,onChange:l=>e.setData("stock",Number(l.target.value)),errorMsg:e.errors.stock,hideError:e.isDirty("stock"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(p,{label:"Barcode",type:"number",name:"barcode",value:e.data.barcode??void 0,className:"remove-arrow mt-1 block w-full",disabled:a.state==="show"||e.processing,onChange:l=>e.setData("barcode",l.target.value),errorMsg:e.errors.barcode,hideError:e.isDirty("barcode"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(z,{formProps:e,modalAction:a})}),t.jsx("div",{className:"mt-4",children:t.jsx(G,{label:"Description",value:e.data.description??void 0,onChange:l=>e.setData("description",l.target.value),disabled:a.state==="show"||e.processing,required:!1,errorMsg:e.errors.description,hideError:e.isDirty("description")})})]})}function Q({modalAction:e,setModalAction:a,form:s}){const[r,i]=m.useState(!1);return t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[t.jsxs(R,{type:"submit",disabled:s.processing,children:[" ",e.state==="create"?"Create":"Save"]}),t.jsx(T,{type:"button",onClick:()=>{s.cancel(),a(n=>({...n,open:!1})),s.reset(),s.clearErrors()},children:"Cancel"}),t.jsx(L,{isOpen:r,requestClose:n=>{i(!1),(n==null?void 0:n.toLowerCase().trim())==="delete"&&a(d=>({...d,open:!1}))},product:s.data})]})}function X({modalAction:e,setModalAction:a}){const s=V(e.state==="create"?{name:"",barcode:null,description:null,imageFile:null,img:null,price:null,stock:null}:{...e.data,_method:"patch"},e.data?e.data.id.toString()+e.data.img:e.state);function r(i){i.preventDefault(),s.post(route(`product.${e.state==="edit"?"update":"store"}`,e.state==="edit"?e.data.id:void 0),{onSuccess:()=>{s.clearErrors(),s.reset(),a(()=>({state:"create",data:null,open:!1}))}})}return t.jsxs("form",{className:"mt-3",onSubmit:r,children:[t.jsx(J,{formProps:s,modalAction:e}),t.jsx(Q,{modalAction:e,setModalAction:a,form:s})]})}function Y({product:e}){var i,n;const a=N().props.auth.business.taxPercent,[s,r]=m.useState(!1);return t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"rounded-md border border-blue-gray-100",children:e.img?t.jsx("img",{className:"mx-auto h-40",src:(i=e.img)!=null&&i.startsWith("http")?e.img:"products-images/"+e.img,alt:"Image of product "+e.name}):t.jsx(y,{className:"!my-1"})}),t.jsx(c,{k:"Name",v:e.name}),t.jsx(c,{k:"Price (Tax included)",v:t.jsx(h,{amount:e.price===null?null:e.price*(1+a),defaultNoAmount:!0,showCurrency:!0})}),t.jsx(c,{k:"Price (Tax not included)",v:t.jsx(h,{amount:e.price,defaultNoAmount:!0,showCurrency:!0})}),t.jsx(c,{k:"Stock",v:t.jsx(h,{amount:e.stock,defaultNoAmount:!0})}),t.jsx(c,{k:"Barcode",v:e.barcode}),t.jsx(c,{k:"Description",v:e.description}),t.jsxs("div",{className:"space-y-3 border-t",hidden:!s,children:[t.jsx(c,{className:"mt-3",k:"Created by",v:(n=e.created_by)==null?void 0:n.name}),t.jsx(c,{title:new Date(e.created_at).toDateString(),className:"mt-3",k:"Created",v:t.jsx(v,{date:e.created_at})}),t.jsx(c,{title:new Date(e.updated_at).toDateString(),className:"mt-3",k:"Updated",v:t.jsx(v,{date:e.updated_at})})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(w.IconButton,{title:"More info",className:"rounded-full",onClick:()=>r(d=>!d),children:s?t.jsx(K,{}):t.jsx(O,{})})})]})}function Z({modalAction:e,setModalAction:a}){return t.jsx(W,{title:A(e.state),open:e.open,closeModal:()=>a(s=>({...s,open:!1})),children:e.state==="show"?t.jsx(Y,{product:e.data}):t.jsx(X,{modalAction:e,setModalAction:a})})}function A(e){return e==="create"?"Add New Product":e==="edit"?"Edit Product":"View Product"}function Te({auth:e,products:a}){const s=a.data,[r,i]=m.useState({state:"create",open:!1,data:null});return t.jsxs(t.Fragment,{children:[t.jsx(Z,{modalAction:r,setModalAction:i}),t.jsxs(S,{user:e.user,header:t.jsx(U,{totalResult:a.total,requestCreateProduct:()=>i({state:"create",open:!0,data:null})}),children:[t.jsx(I,{title:"Inventory"}),t.jsxs("div",{className:"flex min-h-[75vh] flex-col justify-between",children:[t.jsxs("div",{className:"flex flex-wrap justify-center py-6",children:[s.length===0&&t.jsxs("div",{className:"my-20 flex gap-4 opacity-50",children:[t.jsx(M,{className:"mt-1"}),t.jsx("p",{children:"No products found!"})]}),s.map(n=>t.jsx(F,{product:n,requestShow:()=>i({state:"show",open:!0,data:n}),requestEdit:()=>i({state:"edit",data:n,open:!0})},n.id))]}),t.jsx(E,{paginateItems:a}),t.jsx($,{})]})]})]})}export{Te as default};
