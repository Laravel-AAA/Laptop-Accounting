import{r as m,j as t,q as v,a as P}from"./app-343c4aa9.js";import{A as I}from"./index-36e7a24c.js";import S from"./Product-cd802f98.js";import{P as F}from"./Pagination-184ea0c7.js";import{B as E}from"./index.esm-aea19c13.js";import{I as p,H as j}from"./Input-57a95dc5.js";import{D as M,S as q}from"./SecondaryMaterialBtn-5be6396c.js";import{S as T}from"./SecondaryButton-e4db51ea.js";import N from"./NoImageImage-0aea3afb.js";import{C as B}from"./Checkbox-ed64582a.js";import{N as _}from"./Num-96abf7a7.js";import{r as y}from"./index-bcd7de63.js";import{E as H}from"./ErrorMessage-90e1bf04.js";import{D as L}from"./ProductOptions-ed13df7e.js";import{P as R}from"./PrimaryMaterialBtn-66bf6bc3.js";import{u as V}from"./useBetterForm-720d06a2.js";import{T as W}from"./TemplateModal-0e21b8ff.js";import{F as f}from"./FromDate-1b4afe8d.js";import{K as c}from"./KeyValue-a0022af7.js";import{d as K,e as O}from"./index.esm-3f8a9686.js";import U from"./InventoryHeader-14a7ee3f.js";import{F as $}from"./Footer-e4cfb6e6.js";import"./Logo-97abc5bc.js";import"./Dropdown-e28379dd.js";import"./transition-11d8b5d4.js";import"./index.esm-6e0d9836.js";import"./iconBase-1a220b0c.js";import"./index-493a9c48.js";import"./AlertModal-4cd63d2a.js";import"./usePrevious-c69b7809.js";import"./SupportEmailLink-1620de5f.js";function z({formProps:e,modalAction:a}){const s=a.state,r=e.data.img,[i,n]=m.useState(()=>"default");return s==="create"?t.jsx(h,{img:r,state:s,editImageState:i,form:e}):s==="show"?r===null?t.jsx(N,{}):t.jsx(b,{img:r,productName:e.data.name}):r===null?t.jsx(h,{img:r,state:s,editImageState:i,form:e}):i==="default"?t.jsxs(t.Fragment,{children:[t.jsx(b,{img:r,productName:e.data.name}),t.jsxs("div",{className:"mb-4 mt-1 flex justify-center gap-8",children:[t.jsx(T,{disabled:e.processing,onClick:()=>{n("change")},children:"Change Image"}),t.jsx(M,{disabled:e.processing,onClick:()=>{n("removed"),e.setData("img",null)},children:"Remove Image"})]})]}):t.jsx(h,{img:r,state:s,editImageState:i,form:e})}function b({img:e,productName:a}){return t.jsx("div",{className:"mt-1  rounded-md border border-gray-300",children:t.jsx("img",{className:"mx-auto h-40",src:e!=null&&e.startsWith("http")?e:"products-images/"+e,alt:"Image "+(e??"")+" of product "+a})})}function h({img:e,state:a,editImageState:s,form:r}){return t.jsxs(t.Fragment,{children:[t.jsx(p,{label:(e===null&&a==="edit"||s==="removed"||a==="create"?"Choose ":s==="change"?"Change ":"")+"Image",type:"file",className:"mt-1 block w-full",accept:"image/*",hidden:!!e,disabled:a==="show"||r.processing,required:!1,onChange:i=>{var n;r.setData("imageFile",((n=i.target.files)==null?void 0:n[0])??null)},errorMsg:r.errors.img||r.errors.imageFile,hideError:r.isDirty("img")||r.isDirty("imageFile"),hint:"We recommend an image with white background"}),r.progress&&t.jsx("div",{className:"my-1 h-2.5 w-full rounded-md bg-gray-200 dark:bg-gray-700",children:t.jsx("div",{style:{width:r.progress+"%"},className:"h-2.5 rounded-md bg-green-600 dark:bg-green-500"})})]})}function G({color:e="teal",variant:a="outlined",size:s="lg",className:r="",errorMsg:i,errorMsgProps:n,hideError:d,error:o,hint:l,hintProps:u,label:x,disabled:g,required:w,autoComplete:ee="off",id:C=x.toLowerCase().replaceAll(/[^\w]/g,"-"),name:k=x.toLowerCase().replaceAll(/[^\w]/g,"-"),ref:te,...D}){return o===void 0&&(d===!0?o=!1:i?o=!0:o=!1),t.jsxs(t.Fragment,{children:[t.jsx(y.Textarea,{id:C,name:k,label:x,"aria-label":x,className:r+" focus:ring-0",variant:a,color:e,size:s,error:o,disabled:g,required:g===!0?!1:w,...D}),t.jsx(H,{message:i,...n}),typeof l=="string"?t.jsx(j,{message:l,...u}):t.jsx(j,{children:l})]})}function J({formProps:e,modalAction:a}){const[s,r]=m.useState(!1),[i,n]=m.useState(e.data.price),d=v().props.auth.business.taxPercent;function o(l){return l==null?l:Number(Number(l).toFixed(8))}return t.jsxs("div",{className:"",children:[t.jsx("div",{className:"w-full",children:t.jsx(p,{id:"name",label:"Product Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:a.state==="show"||e.processing,onChange:l=>e.setData("name",l.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(p,{id:"price",label:"Price",type:"number",inputMode:"decimal",autoComplete:"off",name:"price",value:i??void 0,className:"mt-1 block w-full",disabled:a.state==="show"||e.processing,onChange:l=>{const u=o(l.target.value);n(u),e.setData("price",o(s?(u??0)/(1+d):u))},errorMsg:e.errors.price,hideError:e.isDirty("price"),required:!1,hint:a.state==="edit"&&t.jsx("span",{children:"If you change the price of this product, it may affect the bills that have already been issued with the old price. This could result in incorrect calculations, such as the total price of a bill. Please make sure you have no bills that have this product."})}),t.jsx(B,{label:t.jsxs("span",{children:["Price includes tax (",t.jsx(_,{showCurrency:!0,amount:e.data.price??0})," without tax)"]}),checked:s,errorMsg:void 0,disabled:e.processing,onChange:l=>{r(u=>(e.setData("price",o(i!=null&&!u?i/(1+d):i)),!u))}})]}),t.jsx("div",{className:"mt-3",children:t.jsx(p,{id:"stock",label:"Stock",type:"number",name:"stock",value:e.data.stock??void 0,className:"mt-1 block w-full",disabled:a.state==="show"||e.processing,onChange:l=>e.setData("stock",Number(l.target.value)),errorMsg:e.errors.stock,hideError:e.isDirty("stock"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(p,{label:"Barcode",type:"number",name:"barcode",value:e.data.barcode??void 0,className:"remove-arrow mt-1 block w-full",disabled:a.state==="show"||e.processing,onChange:l=>e.setData("barcode",l.target.value),errorMsg:e.errors.barcode,hideError:e.isDirty("barcode"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(z,{formProps:e,modalAction:a})}),t.jsx("div",{className:"mt-4",children:t.jsx(G,{label:"Description",value:e.data.description??void 0,onChange:l=>e.setData("description",l.target.value),disabled:a.state==="show"||e.processing,required:!1,errorMsg:e.errors.description,hideError:e.isDirty("description")})})]})}function Q({modalAction:e,setModalAction:a,form:s}){const[r,i]=m.useState(!1);return t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[t.jsxs(R,{type:"submit",disabled:s.processing,children:[" ",e.state==="create"?"Create":"Save"]}),t.jsx(q,{type:"button",onClick:()=>{s.cancel(),a(n=>({...n,open:!1})),s.reset(),s.clearErrors()},children:"Cancel"}),t.jsx(L,{isOpen:r,requestClose:n=>{i(!1),(n==null?void 0:n.toLowerCase().trim())==="delete"&&a(d=>({...d,open:!1}))},product:s.data})]})}function X({modalAction:e,setModalAction:a}){const s=V(e.state==="create"?{name:"",barcode:null,description:null,imageFile:null,img:null,price:null,stock:null}:{...e.data,_method:"patch"},e.data?e.data.id.toString()+e.data.img:e.state);function r(i){i.preventDefault(),s.post(route(`product.${e.state==="edit"?"update":"store"}`,e.state==="edit"?e.data.id:void 0),{onSuccess:()=>{s.clearErrors(),s.reset(),a(()=>({state:"create",data:null,open:!1}))}})}return t.jsxs("form",{className:"mt-3",onSubmit:r,children:[t.jsx(J,{formProps:s,modalAction:e}),t.jsx(Q,{modalAction:e,setModalAction:a,form:s})]})}function Y({product:e}){var i,n;const a=v().props.auth.business.taxPercent,[s,r]=m.useState(!1);return t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"rounded-md border border-blue-gray-100",children:e.img?t.jsx("img",{className:"mx-auto h-40",src:(i=e.img)!=null&&i.startsWith("http")?e.img:"products-images/"+e.img,alt:"Image of product "+e.name}):t.jsx(N,{className:"!my-1"})}),t.jsx(c,{k:"Name",v:e.name}),t.jsx(c,{k:"Price (Tax included)",numProps:{amount:e.price===null?null:e.price*(1+a),defaultNoAmount:!0,showCurrency:!0}}),t.jsx(c,{k:"Price (Tax not included)",numProps:{amount:e.price,defaultNoAmount:!0,showCurrency:!0}}),t.jsx(c,{k:"Stock",numProps:{amount:e.stock,defaultNoAmount:!0}}),t.jsx(c,{k:"Barcode",v:e.barcode}),t.jsx(c,{k:"Description",v:e.description}),t.jsxs("div",{className:"space-y-3 border-t",hidden:!s,children:[t.jsx(c,{className:"mt-3",k:"Created by",v:(n=e.created_by)==null?void 0:n.name}),t.jsx(c,{title:new Date(e.created_at).toDateString(),className:"mt-3",k:"Created",v:t.jsx(f,{date:e.created_at})}),t.jsx(c,{title:new Date(e.updated_at).toDateString(),className:"mt-3",k:"Updated",v:t.jsx(f,{date:e.updated_at})})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(y.IconButton,{title:"More info",className:"rounded-full",onClick:()=>r(d=>!d),children:s?t.jsx(K,{}):t.jsx(O,{})})})]})}function Z({modalAction:e,setModalAction:a}){return t.jsx(W,{title:A(e.state),open:e.open,closeModal:()=>a(s=>({...s,open:!1})),children:e.state==="show"?t.jsx(Y,{product:e.data}):t.jsx(X,{modalAction:e,setModalAction:a})})}function A(e){return e==="create"?"Add New Product":e==="edit"?"Edit Product":"View Product"}function qe({auth:e,products:a}){const s=a.data,[r,i]=m.useState({state:"create",open:!1,data:null});return t.jsxs(t.Fragment,{children:[t.jsx(Z,{modalAction:r,setModalAction:i}),t.jsxs(I,{user:e.user,header:t.jsx(U,{totalResult:a.total,requestCreateProduct:()=>i({state:"create",open:!0,data:null})}),children:[t.jsx(P,{title:"Inventory"}),t.jsxs("div",{className:"flex min-h-[75vh] flex-col justify-between",children:[t.jsxs("div",{className:"flex flex-wrap justify-center py-6",children:[s.length===0&&t.jsxs("div",{className:"my-20 flex gap-4 opacity-50",children:[t.jsx(E,{className:"mt-1"}),t.jsx("p",{children:"No products found!"})]}),s.map(n=>t.jsx(S,{product:n,requestShow:()=>i({state:"show",open:!0,data:n}),requestEdit:()=>i({state:"edit",data:n,open:!0})},n.id))]}),t.jsx(F,{paginateItems:a}),t.jsx($,{})]})]})]})}export{qe as default};
