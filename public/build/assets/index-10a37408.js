import{j as t,r as g,q as D,a as P}from"./app-d4c37d60.js";import{A as k}from"./index-62d03b11.js";import I from"./Product-43321ce3.js";import{P as F}from"./Pagination-9a761cb7.js";import{B as E}from"./index.esm-da9db9ac.js";import{I as m,H as f}from"./Input-6e7894f6.js";import{D as v}from"./DangerButton-f25663d8.js";import S from"./NoImageImage-cdba5481.js";import{C as q}from"./Checkbox-f1ca8a59.js";import{N as B}from"./Num-d1e0c6f4.js";import{r as M}from"./index-392c9826.js";import{E as T}from"./ErrorMessage-659c54b3.js";import{P as j}from"./PrimaryButton-e38e9bd6.js";import{S as H}from"./SecondaryButton-19e0a6ba.js";import{D as L}from"./ProductOptions-bfd4c0ad.js";import{u as R}from"./useBetterForm-03e97d95.js";import{T as O}from"./TemplateModal-059ebec3.js";import W from"./InventoryHeader-41d839d8.js";import{F as $}from"./Footer-c845ec89.js";import"./Dropdown-528cd4a4.js";import"./transition-67620f07.js";import"./index.esm-c1071440.js";import"./iconBase-07391ed9.js";import"./index-61ccea2f.js";import"./AlertModal-01a533af.js";import"./usePrevious-e641edb5.js";function y({type:e="button",className:r="",disabled:s,children:a,...i}){return t.jsx("button",{...i,type:e,className:`inline-block items-center rounded-md border
        border-transparent bg-indigo-700 px-4
        py-2 text-center  text-xs font-semibold
        uppercase tracking-widest
        text-white transition duration-200
        ease-in-out hover:bg-indigo-600 focus:outline-none focus:ring-2  focus:ring-indigo-300
        focus:ring-offset-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300
        focus-visible:ring-offset-2 active:scale-95
         disabled:opacity-25 disabled:active:scale-100 ${s?"cursor-not-allowed opacity-25":"cursor-pointer"} `+r,disabled:s,children:a})}function V({formProps:e,modalAction:r}){const s=r.state,a=e.data.img,[i,o]=g.useState(()=>"default");return s==="create"?t.jsx(h,{img:a,state:s,editImageState:i,form:e}):s==="show"?a===null?t.jsx(S,{}):t.jsx(b,{img:a,productName:e.data.name}):a===null?t.jsx(h,{img:a,state:s,editImageState:i,form:e}):i==="default"?t.jsxs(t.Fragment,{children:[t.jsx(b,{img:a,productName:e.data.name}),t.jsxs("div",{className:"mb-4 mt-1 flex justify-center gap-8",children:[t.jsx(y,{disabled:e.processing,onClick:()=>{o("change")},children:"Change Image"}),t.jsx(v,{disabled:e.processing,onClick:()=>{o("removed"),e.setData("img",null)},children:"Remove Image"})]})]}):t.jsx(h,{img:a,state:s,editImageState:i,form:e})}function b({img:e,productName:r}){return t.jsx("div",{className:"mt-1  rounded-md border border-gray-300",children:t.jsx("img",{className:"mx-auto h-40",src:e!=null&&e.startsWith("http")?e:"products-images/"+e,alt:"Image "+(e??"")+" of product "+r})})}function h({img:e,state:r,editImageState:s,form:a}){return t.jsxs(t.Fragment,{children:[t.jsx(m,{label:(e===null&&r==="edit"||s==="removed"||r==="create"?"Choose ":s==="change"?"Change ":"")+"Image",type:"file",className:"mt-1 block w-full",accept:"image/*",hidden:!!e,disabled:r==="show"||a.processing,required:!1,onChange:i=>{var o;a.setData("imageFile",((o=i.target.files)==null?void 0:o[0])??null)},errorMsg:a.errors.img||a.errors.imageFile,hideError:a.isDirty("img")||a.isDirty("imageFile"),hint:"We recommend an image with white background"}),a.progress&&t.jsx("div",{className:"my-1 h-2.5 w-full rounded-md bg-gray-200 dark:bg-gray-700",children:t.jsx("div",{style:{width:a.progress+"%"},className:"h-2.5 rounded-md bg-green-600 dark:bg-green-500"})})]})}function _({color:e="teal",variant:r="outlined",size:s="lg",className:a="",errorMsg:i,errorMsgProps:o,hideError:u,error:l,hint:n,hintProps:c,label:p,disabled:d,required:x,autoComplete:Q="off",id:N=p.toLowerCase().replaceAll(/[^\w]/g,"-"),name:w=p.toLowerCase().replaceAll(/[^\w]/g,"-"),ref:U,...C}){return l===void 0&&(u===!0?l=!1:i?l=!0:l=!1),t.jsxs(t.Fragment,{children:[t.jsx(M.Textarea,{id:N,name:w,label:p,"aria-label":p,className:a+" focus:ring-0",variant:r,color:e,size:s,error:l,disabled:d,required:d===!0?!1:x,...C}),t.jsx(T,{message:i,...o}),typeof n=="string"?t.jsx(f,{message:n,...c}):t.jsx(f,{children:n})]})}function z({formProps:e,modalAction:r}){const[s,a]=g.useState(!1),[i,o]=g.useState(e.data.price),u=D().props.auth.business.taxPercent;function l(n){return n==null?n:Number(Number(n).toFixed(8))}return t.jsxs("div",{className:"",children:[t.jsx("div",{className:"w-full",children:t.jsx(m,{id:"name",label:"Product Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:r.state==="show"||e.processing,onChange:n=>e.setData("name",n.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(m,{id:"price",label:"Price",type:"number",inputMode:"decimal",autoComplete:"off",name:"price",value:i??void 0,className:"mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:n=>{const c=l(n.target.value);o(c),e.setData("price",l(s?(c??0)/(1+u):c))},errorMsg:e.errors.price,hideError:e.isDirty("price"),required:!1}),t.jsx(q,{label:t.jsxs("span",{children:["Price includes tax (",t.jsx(B,{showCurrency:!0,amount:e.data.price??0})," without tax)"]}),checked:s,errorMsg:void 0,disabled:e.processing,onChange:n=>{a(c=>(e.setData("price",l(i!=null&&!c?i/(1+u):i)),!c))}})]}),t.jsx("div",{className:"mt-3",children:t.jsx(m,{id:"stock",label:"Stock",type:"number",name:"stock",value:e.data.stock??void 0,className:"mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:n=>e.setData("stock",Number(n.target.value)),errorMsg:e.errors.stock,hideError:e.isDirty("stock"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(m,{label:"Barcode",type:"number",name:"barcode",value:e.data.barcode??void 0,className:"remove-arrow mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:n=>e.setData("barcode",n.target.value),errorMsg:e.errors.barcode,hideError:e.isDirty("barcode"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(V,{formProps:e,modalAction:r})}),t.jsx("div",{className:"mt-4",children:t.jsx(_,{label:"Description",value:e.data.description??void 0,onChange:n=>e.setData("description",n.target.value),disabled:r.state==="show"||e.processing,required:!1,errorMsg:e.errors.description,hideError:e.isDirty("description")})})]})}function G({modalAction:e,setModalAction:r,formProps:s}){const[a,i]=g.useState(!1),o=t.jsx(y,{type:"button",onClick:()=>{r(d=>({data:d.data,open:!0,state:"edit"}))},disabled:s.processing,children:"Edit"}),u=t.jsx(v,{disabled:s.processing,onClick:()=>i(!0),children:"Delete"}),l=t.jsx(j,{type:"submit",disabled:s.processing,children:"Create"}),n=t.jsx(H,{type:"button",onClick:()=>{s.cancel(),r(d=>({...d,open:!1})),s.reset(),s.clearErrors()},children:"Cancel"}),c=t.jsx(j,{type:"submit",disabled:s.processing,children:"Save"});function p(){return e.state==="create"?t.jsxs(t.Fragment,{children:[l," ",n]}):e.state==="edit"?t.jsxs(t.Fragment,{children:[c," ",n]}):t.jsxs(t.Fragment,{children:[o," ",u," ",n]})}return t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[p(),t.jsx(L,{isOpen:a,requestClose:d=>{i(!1),(d==null?void 0:d.toLowerCase().trim())==="delete"&&r(x=>({...x,open:!1}))},product:s.data})]})}function J({modalAction:e,setModalAction:r}){const s=R(e.state==="create"?{name:"",barcode:null,description:null,imageFile:null,img:null,price:null,stock:null}:{...e.data,_method:"patch"},e.data?e.data.id.toString()+e.data.img:e.state);function a(i){i.preventDefault(),s.post(route(`product.${e.state==="edit"?"update":"store"}`,e.state==="edit"?e.data.id:void 0),{onSuccess:()=>{s.clearErrors(),s.reset(),r(()=>({state:"create",data:null,open:!1}))}})}return t.jsxs("form",{className:"mt-3",onSubmit:a,children:[t.jsx(z,{formProps:s,modalAction:e}),t.jsx(G,{modalAction:e,setModalAction:r,formProps:s})]})}function K({modalAction:e,setModalAction:r}){function s(){return e.state==="create"?"Add New Product":e.state==="edit"?"Edit Product":"View Product"}return t.jsx(O,{title:s(),open:e.open,closeModal:()=>r(a=>({...a,open:!1})),children:t.jsx(J,{modalAction:e,setModalAction:r})})}function Ne({auth:e,products:r}){const s=r.data,[a,i]=g.useState({state:"create",open:!1,data:null});return t.jsxs(t.Fragment,{children:[t.jsx(K,{modalAction:a,setModalAction:i}),t.jsxs(k,{user:e.user,header:t.jsx(W,{totalResult:r.total,requestCreateProduct:()=>i({state:"create",open:!0,data:null})}),children:[t.jsx(P,{title:"Inventory"}),t.jsxs("div",{className:"flex min-h-[75vh] flex-col justify-between",children:[t.jsxs("div",{className:"flex flex-wrap justify-center py-6",children:[s.length===0&&t.jsxs("div",{className:"my-20 flex gap-4 opacity-50",children:[t.jsx(E,{className:"mt-1"}),t.jsx("p",{children:"No products found!"})]}),s.map(o=>t.jsx(I,{product:o,requestShow:()=>i({state:"show",open:!0,data:o}),requestEdit:()=>i({state:"edit",data:o,open:!0})},o.id))]}),t.jsx(F,{paginateItems:r}),t.jsx($,{})]})]})]})}export{Ne as default};
