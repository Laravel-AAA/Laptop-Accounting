import{j as e,r as x,W as N,b as y}from"./app-dd313135.js";import{A as C}from"./index-d8735d7c.js";import w from"./Product-2e46ad47.js";import{P as I}from"./Pagination-b6a700c6.js";import{e as k,B as F}from"./index.esm-8defed37.js";import{I as m}from"./InputError-31469ee7.js";import{I as p}from"./InputLabel-87739410.js";import{T as g}from"./TextInput-d72e27c0.js";import{D as j}from"./DangerButton-ad406bde.js";import{I as P}from"./InputHint-9eaf2a43.js";import{C as S}from"./Checkbox-1fe8915b.js";import{N as D}from"./Num-dabff9b6.js";import{P as f}from"./PrimaryButton-83bf4880.js";import{S as E}from"./SecondaryButton-16255ccf.js";import{D as B}from"./ProductOptions-b6fae951.js";import{T}from"./TemplateModal-0b1aa5e7.js";import q from"./InventoryHeader-b2082a00.js";import"./Dropdown-dafb2859.js";import"./transition-9da6ec54.js";import"./index.esm-92086401.js";import"./iconBase-2f17a443.js";import"./index-387d7a00.js";import"./AlertModal-c39dbbe0.js";function b({type:t="button",className:r="",disabled:a,children:s,...i}){return e.jsx("button",{...i,type:t,className:`inline-block cursor-pointer items-center rounded-md border
        border-transparent bg-indigo-700 px-4
        py-2 text-center  text-xs font-semibold
        uppercase tracking-widest
        text-white transition duration-200 
        ease-in-out hover:bg-indigo-600 focus:outline-none focus:ring-2  focus:ring-indigo-300
        focus:ring-offset-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300
        focus-visible:ring-offset-2 active:scale-95
         disabled:opacity-25 disabled:active:scale-100 ${a&&"opacity-25"} `+r,disabled:a,children:s})}function M({formProps:t,modalAction:r}){const a=r.state,s=t.data.img,[i,o]=x.useState(()=>"default"),l=e.jsx("div",{className:"mt-1  rounded-md border border-gray-300",children:e.jsx("img",{className:"mx-auto h-40",src:s!=null&&s.startsWith("http")?s:"products-images/"+s,alt:"Image "+(s??"")+" of product "+t.data.name})}),d=e.jsxs(e.Fragment,{children:[e.jsx(g,{id:"img",type:"file",name:"img",className:"mt-1 block w-full",hidden:s,disabled:a==="show",onChange:h=>{var u;t.setData("imageFile",(u=h.target.files)==null?void 0:u[0])}}),t.progress&&e.jsx("div",{className:"my-1 h-2.5 w-full rounded-md bg-gray-200 dark:bg-gray-700",children:e.jsx("div",{style:{width:t.progress+"%"},className:"h-2.5 rounded-md bg-green-600 dark:bg-green-500"})}),e.jsx(m,{message:t.errors.img||t.errors.imageFile,className:"mt-2"}),e.jsx(P,{message:"We recommend an image with white background",className:"mt-2"})]}),n=e.jsx(k,{className:"mx-auto mt-4 h-24 w-24 text-primary-700"});function c(){return a==="create"?d:a==="show"?s===null?n:l:s===null?d:i==="default"?e.jsxs(e.Fragment,{children:[l,e.jsxs("div",{className:"mb-4 mt-1 flex justify-center gap-8",children:[e.jsx(b,{onClick:()=>{o("change")},children:"Change Image"}),e.jsx(j,{onClick:()=>{o("removed"),t.setData("img",null)},children:"Remove Image"})]})]}):d}return e.jsxs(e.Fragment,{children:[e.jsx(p,{htmlFor:"img",value:(s===null&&a==="edit"||i==="removed"||a==="create"?"Choose ":i==="change"?"Change ":"")+"Image"}),c()]})}function R({formProps:t,modalAction:r,taxPercent:a}){const[s,i]=x.useState(!1),[o,l]=x.useState(t.data.price);function d(n){return n==null?n:Number(Number(n).toFixed(8))}return e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(p,{htmlFor:"name",value:"Product Name"}),e.jsx(g,{id:"name",name:"name",value:t.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",isFocused:!0,disabled:r.state==="show",onChange:n=>t.setData("name",n.target.value),required:!0}),e.jsx(m,{message:t.errors.name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(p,{htmlFor:"price",value:"Price"}),e.jsx(g,{id:"price",type:"number",inputMode:"decimal",autoComplete:"off",name:"price",value:o??void 0,className:"mt-1 block w-full",disabled:r.state==="show",onChange:n=>{const c=d(n.target.value);l(c),t.setData("price",d(s?(c??0)/(1+a):c))}}),e.jsx(m,{message:t.errors.price,className:"mt-2"}),e.jsxs("label",{className:"mt-2 flex items-center",children:[e.jsx(S,{name:"remember",checked:s,onChange:n=>{i(c=>(t.setData("price",d(o!=null&&!c?o/(1+a):o)),!c))}}),e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["Price includes tax (",e.jsx(D,{currency:"$",amount:t.data.price??0})," without tax)"]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(p,{htmlFor:"stock",value:"Stock"}),e.jsx(g,{id:"stock",type:"number",inputMode:"numeric",autoComplete:"off",name:"stock",value:t.data.stock??void 0,className:"mt-1 block w-full",disabled:r.state==="show",onChange:n=>t.setData("stock",Number(n.target.value))}),e.jsx(m,{message:t.errors.stock,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(p,{htmlFor:"barcode",value:"Barcode"}),e.jsx(g,{id:"barcode",type:"number",inputMode:"numeric",autoComplete:"off",name:"barcode",value:t.data.barcode??void 0,className:"remove-arrow mt-1 block w-full",disabled:r.state==="show",onChange:n=>t.setData("barcode",n.target.value)}),e.jsx(m,{message:t.errors.barcode,className:"mt-2"})]}),e.jsx("div",{className:"mt-4",children:e.jsx(M,{formProps:t,modalAction:r})})]})}function W({modalAction:t,setModalAction:r,formProps:a}){const[s,i]=x.useState(!1),o=e.jsx(b,{type:"button",onClick:()=>{r(u=>({data:u.data,open:!0,state:"edit"}))},disabled:a.processing,children:"Edit"}),l=e.jsx(j,{disabled:a.processing,onClick:()=>i(!0),children:"Delete"}),d=e.jsx(f,{type:"submit",disabled:a.processing,children:"Create"}),n=e.jsx(E,{type:"button",onClick:()=>{a.cancel(),r(u=>({...u,open:!1})),a.reset(),a.clearErrors()},children:"Cancel"}),c=e.jsx(f,{type:"submit",disabled:a.processing,children:"Save"});function h(){return t.state==="create"?e.jsxs(e.Fragment,{children:[d," ",n]}):t.state==="edit"?e.jsxs(e.Fragment,{children:[c," ",n]}):e.jsxs(e.Fragment,{children:[o," ",l," ",n]})}return e.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[h(),e.jsx(B,{isOpen:s,requestClose:u=>{i(!1),(u==null?void 0:u.toLowerCase().trim())==="delete"&&r(v=>({...v,open:!1}))},product:a.data})]})}function $({modalAction:t,setModalAction:r,taxPercent:a}){const s=N(t.data?t.data.id.toString()+t.data.img:t.state,t.state==="create"?{name:"",barcode:null,description:null,imageFile:null,img:null,price:null,stock:null}:{...t.data,_method:"patch"});function i(o){o.preventDefault(),s.post(route(`product.${t.state==="edit"?"update":"store"}`,t.state==="edit"?t.data.id:void 0),{onSuccess:()=>{s.clearErrors(),s.reset(),r(()=>({state:"create",data:null,open:!1}))}})}return e.jsxs("form",{className:"mt-3",onSubmit:i,children:[e.jsx(R,{taxPercent:a,formProps:s,modalAction:t}),e.jsx(W,{modalAction:t,setModalAction:r,formProps:s})]})}function H({modalAction:t,setModalAction:r,taxPercent:a}){console.log(t.data);function s(){return t.state==="create"?"Add New Product":t.state==="edit"?"Edit Product":"View Product"}return e.jsx(T,{title:s(),open:t.open,closeModal:()=>r(i=>({...i,open:!1})),children:e.jsx($,{taxPercent:a,modalAction:t,setModalAction:r})})}function ce({auth:t,products:r,business:{taxPercent:a}}){const s=r.data,[i,o]=x.useState({state:"create",open:!1,data:null});return console.log(s),e.jsxs(e.Fragment,{children:[e.jsx(H,{modalAction:i,setModalAction:o,taxPercent:a}),e.jsxs(C,{user:t.user,header:e.jsx(q,{totalResult:r.total,requestCreateProduct:()=>o({state:"create",open:!0,data:null})}),children:[e.jsx(y,{title:"Inventory"}),e.jsxs("div",{className:"flex flex-wrap  justify-center py-6",children:[s.length===0&&e.jsxs("div",{className:"my-20 flex gap-4 opacity-50",children:[e.jsx(F,{className:"mt-1"}),e.jsx("p",{children:"No products found!"})]}),s.map(l=>e.jsx(w,{product:l,taxPercent:a,requestShow:()=>o({state:"show",open:!0,data:l}),requestEdit:()=>o({state:"edit",data:l,open:!0})},l.id))]}),e.jsx(I,{paginateItems:r})]})]})}export{ce as default};
