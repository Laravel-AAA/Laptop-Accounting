import{j as s,r as m,q as N,a as E}from"./app-597d038e.js";import{A as q}from"./index-eb459fca.js";import M from"./Product-ae6e3c28.js";import{P as T}from"./Pagination-9ee0bab4.js";import{B}from"./index.esm-c698fa55.js";import{I as p,H as f}from"./Input-568c2f70.js";import{D as w}from"./DangerButton-a14afe1f.js";import{S as C}from"./SecondaryButton-0005ea90.js";import k from"./NoImageImage-527cc7d4.js";import{C as _}from"./Checkbox-01cbad46.js";import{N as H}from"./Num-5d713926.js";import{r as D}from"./index-1f12a61e.js";import{E as L}from"./ErrorMessage-59b540d3.js";import{P as b}from"./PrimaryButton-b02ed71d.js";import{D as R}from"./ProductOptions-0e89858f.js";import{u as V}from"./useBetterForm-1e02708f.js";import{T as W}from"./TemplateModal-aa8f79b5.js";import{F as v}from"./FromDate-6f3269dd.js";import{K as c}from"./KeyValue-9489a525.js";import{d as K,e as O}from"./index.esm-d6f9327b.js";import U from"./InventoryHeader-9e9ebcb8.js";import{F as $}from"./Footer-f327b109.js";import"./Dropdown-7d7d7dcf.js";import"./transition-3e3ca368.js";import"./index.esm-0757006a.js";import"./iconBase-a121196f.js";import"./index-9d7526b5.js";import"./AlertModal-8e80492c.js";import"./usePrevious-7d8774f0.js";function z({type:e="button",className:r="",disabled:t,children:a,...i}){return s.jsx("button",{...i,type:e,className:`inline-block items-center rounded-md border
        border-transparent bg-indigo-700 px-4
        py-2 text-center  text-xs font-semibold
        uppercase tracking-widest
        text-white transition duration-200
        ease-in-out hover:bg-indigo-600 focus:outline-none focus:ring-2  focus:ring-indigo-300
        focus:ring-offset-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300
        focus-visible:ring-offset-2 active:scale-95
         disabled:opacity-25 disabled:active:scale-100 ${t?"cursor-not-allowed opacity-25":"cursor-pointer"} `+r,disabled:t,children:a})}function G({formProps:e,modalAction:r}){const t=r.state,a=e.data.img,[i,n]=m.useState(()=>"default");return t==="create"?s.jsx(g,{img:a,state:t,editImageState:i,form:e}):t==="show"?a===null?s.jsx(k,{}):s.jsx(y,{img:a,productName:e.data.name}):a===null?s.jsx(g,{img:a,state:t,editImageState:i,form:e}):i==="default"?s.jsxs(s.Fragment,{children:[s.jsx(y,{img:a,productName:e.data.name}),s.jsxs("div",{className:"mb-4 mt-1 flex justify-center gap-8",children:[s.jsx(C,{disabled:e.processing,onClick:()=>{n("change")},children:"Change Image"}),s.jsx(w,{disabled:e.processing,onClick:()=>{n("removed"),e.setData("img",null)},children:"Remove Image"})]})]}):s.jsx(g,{img:a,state:t,editImageState:i,form:e})}function y({img:e,productName:r}){return s.jsx("div",{className:"mt-1  rounded-md border border-gray-300",children:s.jsx("img",{className:"mx-auto h-40",src:e!=null&&e.startsWith("http")?e:"products-images/"+e,alt:"Image "+(e??"")+" of product "+r})})}function g({img:e,state:r,editImageState:t,form:a}){return s.jsxs(s.Fragment,{children:[s.jsx(p,{label:(e===null&&r==="edit"||t==="removed"||r==="create"?"Choose ":t==="change"?"Change ":"")+"Image",type:"file",className:"mt-1 block w-full",accept:"image/*",hidden:!!e,disabled:r==="show"||a.processing,required:!1,onChange:i=>{var n;a.setData("imageFile",((n=i.target.files)==null?void 0:n[0])??null)},errorMsg:a.errors.img||a.errors.imageFile,hideError:a.isDirty("img")||a.isDirty("imageFile"),hint:"We recommend an image with white background"}),a.progress&&s.jsx("div",{className:"my-1 h-2.5 w-full rounded-md bg-gray-200 dark:bg-gray-700",children:s.jsx("div",{style:{width:a.progress+"%"},className:"h-2.5 rounded-md bg-green-600 dark:bg-green-500"})})]})}function J({color:e="teal",variant:r="outlined",size:t="lg",className:a="",errorMsg:i,errorMsgProps:n,hideError:d,error:l,hint:o,hintProps:u,label:x,disabled:j,required:P,autoComplete:te="off",id:F=x.toLowerCase().replaceAll(/[^\w]/g,"-"),name:I=x.toLowerCase().replaceAll(/[^\w]/g,"-"),ref:re,...S}){return l===void 0&&(d===!0?l=!1:i?l=!0:l=!1),s.jsxs(s.Fragment,{children:[s.jsx(D.Textarea,{id:F,name:I,label:x,"aria-label":x,className:a+" focus:ring-0",variant:r,color:e,size:t,error:l,disabled:j,required:j===!0?!1:P,...S}),s.jsx(L,{message:i,...n}),typeof o=="string"?s.jsx(f,{message:o,...u}):s.jsx(f,{children:o})]})}function Q({formProps:e,modalAction:r}){const[t,a]=m.useState(!1),[i,n]=m.useState(e.data.price),d=N().props.auth.business.taxPercent;function l(o){return o==null?o:Number(Number(o).toFixed(8))}return s.jsxs("div",{className:"",children:[s.jsx("div",{className:"w-full",children:s.jsx(p,{id:"name",label:"Product Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:r.state==="show"||e.processing,onChange:o=>e.setData("name",o.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")})}),s.jsxs("div",{className:"mt-4",children:[s.jsx(p,{id:"price",label:"Price",type:"number",inputMode:"decimal",autoComplete:"off",name:"price",value:i??void 0,className:"mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:o=>{const u=l(o.target.value);n(u),e.setData("price",l(t?(u??0)/(1+d):u))},errorMsg:e.errors.price,hideError:e.isDirty("price"),required:!1}),s.jsx(_,{label:s.jsxs("span",{children:["Price includes tax (",s.jsx(H,{showCurrency:!0,amount:e.data.price??0})," without tax)"]}),checked:t,errorMsg:void 0,disabled:e.processing,onChange:o=>{a(u=>(e.setData("price",l(i!=null&&!u?i/(1+d):i)),!u))}})]}),s.jsx("div",{className:"mt-3",children:s.jsx(p,{id:"stock",label:"Stock",type:"number",name:"stock",value:e.data.stock??void 0,className:"mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:o=>e.setData("stock",Number(o.target.value)),errorMsg:e.errors.stock,hideError:e.isDirty("stock"),required:!1})}),s.jsx("div",{className:"mt-4",children:s.jsx(p,{label:"Barcode",type:"number",name:"barcode",value:e.data.barcode??void 0,className:"remove-arrow mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:o=>e.setData("barcode",o.target.value),errorMsg:e.errors.barcode,hideError:e.isDirty("barcode"),required:!1})}),s.jsx("div",{className:"mt-4",children:s.jsx(G,{formProps:e,modalAction:r})}),s.jsx("div",{className:"mt-4",children:s.jsx(J,{label:"Description",value:e.data.description??void 0,onChange:o=>e.setData("description",o.target.value),disabled:r.state==="show"||e.processing,required:!1,errorMsg:e.errors.description,hideError:e.isDirty("description")})})]})}function X({modalAction:e,setModalAction:r,form:t}){const[a,i]=m.useState(!1);return s.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[e.state==="create"?s.jsxs(s.Fragment,{children:[s.jsx(b,{type:"submit",disabled:t.processing,children:"Create"}),s.jsx(h,{setModalAction:r,form:t})]}):e.state==="edit"?s.jsxs(s.Fragment,{children:[s.jsx(b,{type:"submit",disabled:t.processing,children:"Save"}),s.jsx(h,{setModalAction:r,form:t})]}):s.jsxs(s.Fragment,{children:[s.jsx(Y,{setModalAction:r,form:t}),s.jsx(w,{disabled:t.processing,onClick:()=>i(!0),children:"Delete"}),s.jsx(h,{setModalAction:r,form:t})]}),s.jsx(R,{isOpen:a,requestClose:n=>{i(!1),(n==null?void 0:n.toLowerCase().trim())==="delete"&&r(d=>({...d,open:!1}))},product:t.data})]})}function Y({setModalAction:e,form:r}){return s.jsx(z,{type:"button",onClick:()=>{e(t=>({data:t.data,open:!0,state:"edit"}))},disabled:r.processing,children:"Edit"})}function h({setModalAction:e,form:r}){return s.jsx(C,{type:"button",onClick:()=>{r.cancel(),e(t=>({...t,open:!1})),r.reset(),r.clearErrors()},children:"Cancel"})}function Z({modalAction:e,setModalAction:r}){const t=V(e.state==="create"?{name:"",barcode:null,description:null,imageFile:null,img:null,price:null,stock:null}:{...e.data,_method:"patch"},e.data?e.data.id.toString()+e.data.img:e.state);function a(i){i.preventDefault(),t.post(route(`product.${e.state==="edit"?"update":"store"}`,e.state==="edit"?e.data.id:void 0),{onSuccess:()=>{t.clearErrors(),t.reset(),r(()=>({state:"create",data:null,open:!1}))}})}return s.jsxs("form",{className:"mt-3",onSubmit:a,children:[s.jsx(Q,{formProps:t,modalAction:e}),s.jsx(X,{modalAction:e,setModalAction:r,form:t})]})}function A({product:e}){var i,n;const r=N().props.auth.business.taxPercent,[t,a]=m.useState(!1);return s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"rounded-md border border-blue-gray-100",children:e.img?s.jsx("img",{className:"mx-auto h-40",src:(i=e.img)!=null&&i.startsWith("http")?e.img:"products-images/"+e.img,alt:"Image of product "+e.name}):s.jsx(k,{className:"!my-1"})}),s.jsx(c,{k:"Name",v:e.name}),s.jsx(c,{k:"Price (Tax included)",v:e.price===null?null:e.price*(1+r),vProps:{showCurrency:!0}}),s.jsx(c,{k:"Price (Tax not included)",v:e.price,vProps:{showCurrency:!0}}),s.jsx(c,{k:"Stock",v:e.stock,vProps:{}}),s.jsx(c,{k:"Barcode",v:e.barcode}),s.jsx(c,{k:"Description",v:e.description}),s.jsxs("div",{className:"space-y-3 border-t",hidden:!t,children:[s.jsx(c,{className:"mt-3",k:"Created by",v:(n=e.created_by)==null?void 0:n.name}),s.jsx(c,{title:new Date(e.created_at).toDateString(),className:"mt-3",k:"Created",v:s.jsx(v,{date:e.created_at})}),s.jsx(c,{title:new Date(e.updated_at).toDateString(),className:"mt-3",k:"Updated",v:s.jsx(v,{date:e.updated_at})})]}),s.jsx("div",{className:"flex justify-center",children:s.jsx(D.IconButton,{title:"More info",className:"rounded-full",onClick:()=>a(d=>!d),children:t?s.jsx(K,{}):s.jsx(O,{})})})]})}function ee({modalAction:e,setModalAction:r}){return s.jsx(W,{title:se(e.state),open:e.open,closeModal:()=>r(t=>({...t,open:!1})),children:e.state==="show"?s.jsx(A,{product:e.data}):s.jsx(Z,{modalAction:e,setModalAction:r})})}function se(e){return e==="create"?"Add New Product":e==="edit"?"Edit Product":"View Product"}function Me({auth:e,products:r}){const t=r.data,[a,i]=m.useState({state:"create",open:!1,data:null});return s.jsxs(s.Fragment,{children:[s.jsx(ee,{modalAction:a,setModalAction:i}),s.jsxs(q,{user:e.user,header:s.jsx(U,{totalResult:r.total,requestCreateProduct:()=>i({state:"create",open:!0,data:null})}),children:[s.jsx(E,{title:"Inventory"}),s.jsxs("div",{className:"flex min-h-[75vh] flex-col justify-between",children:[s.jsxs("div",{className:"flex flex-wrap justify-center py-6",children:[t.length===0&&s.jsxs("div",{className:"my-20 flex gap-4 opacity-50",children:[s.jsx(B,{className:"mt-1"}),s.jsx("p",{children:"No products found!"})]}),t.map(n=>s.jsx(M,{product:n,requestShow:()=>i({state:"show",open:!0,data:n}),requestEdit:()=>i({state:"edit",data:n,open:!0})},n.id))]}),s.jsx(T,{paginateItems:r}),s.jsx($,{})]})]})]})}export{Me as default};
