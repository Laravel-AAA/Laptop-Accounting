import{j as t,r as g,q as N,a as C}from"./app-838cb2bb.js";import{A as D}from"./index-8cce2395.js";import P from"./Product-97c60ff9.js";import{P as k}from"./Pagination-200f92bd.js";import{B as F}from"./index.esm-15f0180e.js";import{I as m,H as h}from"./Input-9f56e393.js";import{D as b}from"./DangerButton-a7494810.js";import I from"./NoImageImage-96f74dc4.js";import{C as E}from"./Checkbox-c2e739d4.js";import{N as S}from"./Num-43ff67d1.js";import{r as q}from"./index-82366f85.js";import{E as B}from"./ErrorMessage-0b2ad8a4.js";import{P as f}from"./PrimaryButton-a97409fe.js";import{S as M}from"./SecondaryButton-8c0ceade.js";import{D as T}from"./ProductOptions-96bd6dd4.js";import{u as H}from"./useBetterForm-d6b57cfa.js";import{T as L}from"./TemplateModal-ff4d5015.js";import R from"./InventoryHeader-a8a16433.js";import{F as O}from"./Footer-35a7cf2d.js";import"./Dropdown-3724d36d.js";import"./transition-59daec51.js";import"./index.esm-d6b3890a.js";import"./iconBase-98933817.js";import"./index-1dd53fcd.js";import"./AlertModal-0dabe9fc.js";import"./usePrevious-40a04870.js";function j({type:e="button",className:r="",disabled:s,children:a,...n}){return t.jsx("button",{...n,type:e,className:`inline-block items-center rounded-md border
        border-transparent bg-indigo-700 px-4
        py-2 text-center  text-xs font-semibold
        uppercase tracking-widest
        text-white transition duration-200
        ease-in-out hover:bg-indigo-600 focus:outline-none focus:ring-2  focus:ring-indigo-300
        focus:ring-offset-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300
        focus-visible:ring-offset-2 active:scale-95
         disabled:opacity-25 disabled:active:scale-100 ${s?"cursor-not-allowed opacity-25":"cursor-pointer"} `+r,disabled:s,children:a})}function W({formProps:e,modalAction:r}){const s=r.state,a=e.data.img,[n,l]=g.useState(()=>"default"),u=t.jsx("div",{className:"mt-1  rounded-md border border-gray-300",children:t.jsx("img",{className:"mx-auto h-40",src:a!=null&&a.startsWith("http")?a:"products-images/"+a,alt:"Image "+(a??"")+" of product "+e.data.name})}),o=t.jsxs(t.Fragment,{children:[t.jsx(m,{label:(a===null&&s==="edit"||n==="removed"||s==="create"?"Choose ":n==="change"?"Change ":"")+"Image",type:"file",className:"mt-1 block w-full",hidden:!!a,disabled:s==="show"||e.processing,required:!1,onChange:i=>{var c;e.setData("imageFile",((c=i.target.files)==null?void 0:c[0])??null)},errorMsg:e.errors.img||e.errors.imageFile,hideError:e.isDirty("img")||e.isDirty("imageFile"),hint:"We recommend an image with white background"}),e.progress&&t.jsx("div",{className:"my-1 h-2.5 w-full rounded-md bg-gray-200 dark:bg-gray-700",children:t.jsx("div",{style:{width:e.progress+"%"},className:"h-2.5 rounded-md bg-green-600 dark:bg-green-500"})})]});return s==="create"?o:s==="show"?a===null?t.jsx(I,{}):u:a===null?o:n==="default"?t.jsxs(t.Fragment,{children:[u,t.jsxs("div",{className:"mb-4 mt-1 flex justify-center gap-8",children:[t.jsx(j,{disabled:e.processing,onClick:()=>{l("change")},children:"Change Image"}),t.jsx(b,{disabled:e.processing,onClick:()=>{l("removed"),e.setData("img",null)},children:"Remove Image"})]})]}):o}function $({color:e="teal",variant:r="outlined",size:s="lg",className:a="",errorMsg:n,errorMsgProps:l,hideError:u,error:o,hint:i,hintProps:c,label:p,disabled:d,required:x,autoComplete:J="off",id:v=p.toLowerCase().replaceAll(/[^\w]/g,"-"),name:y=p.toLowerCase().replaceAll(/[^\w]/g,"-"),ref:K,...w}){return o===void 0&&(u===!0?o=!1:n?o=!0:o=!1),t.jsxs(t.Fragment,{children:[t.jsx(q.Textarea,{id:v,name:y,label:p,"aria-label":p,className:a+" focus:ring-0",variant:r,color:e,size:s,error:o,disabled:d,required:d===!0?!1:x,...w}),t.jsx(B,{message:n,...l}),typeof i=="string"?t.jsx(h,{message:i,...c}):t.jsx(h,{children:i})]})}function V({formProps:e,modalAction:r}){const[s,a]=g.useState(!1),[n,l]=g.useState(e.data.price),u=N().props.auth.business.taxPercent;function o(i){return i==null?i:Number(Number(i).toFixed(8))}return t.jsxs("div",{className:"",children:[t.jsx("div",{className:"w-full",children:t.jsx(m,{id:"name",label:"Product Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:r.state==="show"||e.processing,onChange:i=>e.setData("name",i.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(m,{id:"price",label:"Price",type:"number",inputMode:"decimal",autoComplete:"off",name:"price",value:n??void 0,className:"mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:i=>{const c=o(i.target.value);l(c),e.setData("price",o(s?(c??0)/(1+u):c))},errorMsg:e.errors.price,hideError:e.isDirty("price"),required:!1}),t.jsx(E,{name:"remember",label:t.jsxs("span",{children:["Price includes tax (",t.jsx(S,{showCurrency:!0,amount:e.data.price??0})," without tax)"]}),checked:s,errorMsg:void 0,disabled:e.processing,onChange:i=>{a(c=>(e.setData("price",o(n!=null&&!c?n/(1+u):n)),!c))}})]}),t.jsx("div",{className:"mt-3",children:t.jsx(m,{id:"stock",label:"Stock",type:"number",name:"stock",value:e.data.stock??void 0,className:"mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:i=>e.setData("stock",Number(i.target.value)),errorMsg:e.errors.stock,hideError:e.isDirty("stock"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(m,{label:"Barcode",type:"number",name:"barcode",value:e.data.barcode??void 0,className:"remove-arrow mt-1 block w-full",disabled:r.state==="show"||e.processing,onChange:i=>e.setData("barcode",i.target.value),errorMsg:e.errors.barcode,hideError:e.isDirty("barcode"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(W,{formProps:e,modalAction:r})}),t.jsx("div",{className:"mt-4",children:t.jsx($,{label:"Description",value:e.data.description??void 0,onChange:i=>e.setData("description",i.target.value),disabled:r.state==="show"||e.processing,required:!1,errorMsg:e.errors.description,hideError:e.isDirty("description")})})]})}function _({modalAction:e,setModalAction:r,formProps:s}){const[a,n]=g.useState(!1),l=t.jsx(j,{type:"button",onClick:()=>{r(d=>({data:d.data,open:!0,state:"edit"}))},disabled:s.processing,children:"Edit"}),u=t.jsx(b,{disabled:s.processing,onClick:()=>n(!0),children:"Delete"}),o=t.jsx(f,{type:"submit",disabled:s.processing,children:"Create"}),i=t.jsx(M,{type:"button",onClick:()=>{s.cancel(),r(d=>({...d,open:!1})),s.reset(),s.clearErrors()},children:"Cancel"}),c=t.jsx(f,{type:"submit",disabled:s.processing,children:"Save"});function p(){return e.state==="create"?t.jsxs(t.Fragment,{children:[o," ",i]}):e.state==="edit"?t.jsxs(t.Fragment,{children:[c," ",i]}):t.jsxs(t.Fragment,{children:[l," ",u," ",i]})}return t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[p(),t.jsx(T,{isOpen:a,requestClose:d=>{n(!1),(d==null?void 0:d.toLowerCase().trim())==="delete"&&r(x=>({...x,open:!1}))},product:s.data})]})}function z({modalAction:e,setModalAction:r}){const s=H(e.state==="create"?{name:"",barcode:null,description:null,imageFile:null,img:null,price:null,stock:null}:{...e.data,_method:"patch"},e.data?e.data.id.toString()+e.data.img:e.state);function a(n){n.preventDefault(),s.post(route(`product.${e.state==="edit"?"update":"store"}`,e.state==="edit"?e.data.id:void 0),{onSuccess:()=>{s.clearErrors(),s.reset(),r(()=>({state:"create",data:null,open:!1}))}})}return t.jsxs("form",{className:"mt-3",onSubmit:a,children:[t.jsx(V,{formProps:s,modalAction:e}),t.jsx(_,{modalAction:e,setModalAction:r,formProps:s})]})}function G({modalAction:e,setModalAction:r}){function s(){return e.state==="create"?"Add New Product":e.state==="edit"?"Edit Product":"View Product"}return t.jsx(L,{title:s(),open:e.open,closeModal:()=>r(a=>({...a,open:!1})),children:t.jsx(z,{modalAction:e,setModalAction:r})})}function ve({auth:e,products:r}){const s=r.data,[a,n]=g.useState({state:"create",open:!1,data:null});return t.jsxs(t.Fragment,{children:[t.jsx(G,{modalAction:a,setModalAction:n}),t.jsxs(D,{user:e.user,header:t.jsx(R,{totalResult:r.total,requestCreateProduct:()=>n({state:"create",open:!0,data:null})}),children:[t.jsx(C,{title:"Inventory"}),t.jsxs("div",{className:"flex min-h-[75vh] flex-col justify-between",children:[t.jsxs("div",{className:"flex flex-wrap justify-center py-6",children:[s.length===0&&t.jsxs("div",{className:"my-20 flex gap-4 opacity-50",children:[t.jsx(F,{className:"mt-1"}),t.jsx("p",{children:"No products found!"})]}),s.map(l=>t.jsx(P,{product:l,requestShow:()=>n({state:"show",open:!0,data:l}),requestEdit:()=>n({state:"edit",data:l,open:!0})},l.id))]}),t.jsx(k,{paginateItems:r}),t.jsx(O,{})]})]})]})}export{ve as default};
