import{j as t,r as p,q as k,a as I}from"./app-6bf2ca34.js";import{A as P}from"./index-298ed233.js";import F from"./Product-01be4c94.js";import{P as E}from"./Pagination-8e59f705.js";import{B as S}from"./index.esm-03b66479.js";import{I as u,H as j}from"./Input-9b591fdf.js";import{D as v}from"./DangerButton-ecbabcb3.js";import q from"./NoImageImage-851dfeb6.js";import{C as M}from"./Checkbox-5bf40bc6.js";import{N as T}from"./Num-8450bffb.js";import{r as B}from"./index-9cffb418.js";import{E as H}from"./ErrorMessage-868468ff.js";import{P as f}from"./PrimaryButton-85e0aa66.js";import{S as L}from"./SecondaryButton-366dc984.js";import{D as R}from"./ProductOptions-025622fc.js";import{u as O}from"./useBetterForm-3beba221.js";import{T as W}from"./TemplateModal-645fca39.js";import $ from"./InventoryHeader-c452029a.js";import{F as V}from"./Footer-e0f38298.js";import"./Dropdown-d28ee306.js";import"./transition-e5ac88d8.js";import"./index.esm-e1bfef5e.js";import"./iconBase-24fa898f.js";import"./index-dc0315e9.js";import"./AlertModal-bd93e8f9.js";import"./usePrevious-e6d1e6b7.js";function y({type:e="button",className:s="",disabled:r,children:a,...i}){return t.jsx("button",{...i,type:e,className:`inline-block items-center rounded-md border
        border-transparent bg-indigo-700 px-4
        py-2 text-center  text-xs font-semibold
        uppercase tracking-widest
        text-white transition duration-200
        ease-in-out hover:bg-indigo-600 focus:outline-none focus:ring-2  focus:ring-indigo-300
        focus:ring-offset-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300
        focus-visible:ring-offset-2 active:scale-95
         disabled:opacity-25 disabled:active:scale-100 ${r?"cursor-not-allowed opacity-25":"cursor-pointer"} `+s,disabled:r,children:a})}function _({formProps:e,modalAction:s}){const r=s.state,a=e.data.img,[i,n]=p.useState(()=>"default");return r==="create"?t.jsx(g,{img:a,state:r,editImageState:i,form:e}):r==="show"?a===null?t.jsx(q,{}):t.jsx(b,{img:a,productName:e.data.name}):a===null?t.jsx(g,{img:a,state:r,editImageState:i,form:e}):i==="default"?t.jsxs(t.Fragment,{children:[t.jsx(b,{img:a,productName:e.data.name}),t.jsxs("div",{className:"mb-4 mt-1 flex justify-center gap-8",children:[t.jsx(y,{disabled:e.processing,onClick:()=>{n("change")},children:"Change Image"}),t.jsx(v,{disabled:e.processing,onClick:()=>{n("removed"),e.setData("img",null)},children:"Remove Image"})]})]}):t.jsx(g,{img:a,state:r,editImageState:i,form:e})}function b({img:e,productName:s}){return t.jsx("div",{className:"mt-1  rounded-md border border-gray-300",children:t.jsx("img",{className:"mx-auto h-40",src:e!=null&&e.startsWith("http")?e:"products-images/"+e,alt:"Image "+(e??"")+" of product "+s})})}function g({img:e,state:s,editImageState:r,form:a}){return t.jsxs(t.Fragment,{children:[t.jsx(u,{label:(e===null&&s==="edit"||r==="removed"||s==="create"?"Choose ":r==="change"?"Change ":"")+"Image",type:"file",className:"mt-1 block w-full",accept:"image/*",hidden:!!e,disabled:s==="show"||a.processing,required:!1,onChange:i=>{var n;a.setData("imageFile",((n=i.target.files)==null?void 0:n[0])??null)},errorMsg:a.errors.img||a.errors.imageFile,hideError:a.isDirty("img")||a.isDirty("imageFile"),hint:"We recommend an image with white background"}),a.progress&&t.jsx("div",{className:"my-1 h-2.5 w-full rounded-md bg-gray-200 dark:bg-gray-700",children:t.jsx("div",{style:{width:a.progress+"%"},className:"h-2.5 rounded-md bg-green-600 dark:bg-green-500"})})]})}function z({color:e="teal",variant:s="outlined",size:r="lg",className:a="",errorMsg:i,errorMsgProps:n,hideError:d,error:l,hint:o,hintProps:c,label:m,disabled:h,required:N,autoComplete:Y="off",id:w=m.toLowerCase().replaceAll(/[^\w]/g,"-"),name:C=m.toLowerCase().replaceAll(/[^\w]/g,"-"),ref:Z,...D}){return l===void 0&&(d===!0?l=!1:i?l=!0:l=!1),t.jsxs(t.Fragment,{children:[t.jsx(B.Textarea,{id:w,name:C,label:m,"aria-label":m,className:a+" focus:ring-0",variant:s,color:e,size:r,error:l,disabled:h,required:h===!0?!1:N,...D}),t.jsx(H,{message:i,...n}),typeof o=="string"?t.jsx(j,{message:o,...c}):t.jsx(j,{children:o})]})}function G({formProps:e,modalAction:s}){const[r,a]=p.useState(!1),[i,n]=p.useState(e.data.price),d=k().props.auth.business.taxPercent;function l(o){return o==null?o:Number(Number(o).toFixed(8))}return t.jsxs("div",{className:"",children:[t.jsx("div",{className:"w-full",children:t.jsx(u,{id:"name",label:"Product Name",name:"name",type:"text",value:e.data.name??void 0,className:"mt-1 block w-full",autoComplete:"off",autoFocus:!0,disabled:s.state==="show"||e.processing,onChange:o=>e.setData("name",o.target.value),required:!0,errorMsg:e.errors.name,hideError:e.isDirty("name")})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(u,{id:"price",label:"Price",type:"number",inputMode:"decimal",autoComplete:"off",name:"price",value:i??void 0,className:"mt-1 block w-full",disabled:s.state==="show"||e.processing,onChange:o=>{const c=l(o.target.value);n(c),e.setData("price",l(r?(c??0)/(1+d):c))},errorMsg:e.errors.price,hideError:e.isDirty("price"),required:!1}),t.jsx(M,{label:t.jsxs("span",{children:["Price includes tax (",t.jsx(T,{showCurrency:!0,amount:e.data.price??0})," without tax)"]}),checked:r,errorMsg:void 0,disabled:e.processing,onChange:o=>{a(c=>(e.setData("price",l(i!=null&&!c?i/(1+d):i)),!c))}})]}),t.jsx("div",{className:"mt-3",children:t.jsx(u,{id:"stock",label:"Stock",type:"number",name:"stock",value:e.data.stock??void 0,className:"mt-1 block w-full",disabled:s.state==="show"||e.processing,onChange:o=>e.setData("stock",Number(o.target.value)),errorMsg:e.errors.stock,hideError:e.isDirty("stock"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(u,{label:"Barcode",type:"number",name:"barcode",value:e.data.barcode??void 0,className:"remove-arrow mt-1 block w-full",disabled:s.state==="show"||e.processing,onChange:o=>e.setData("barcode",o.target.value),errorMsg:e.errors.barcode,hideError:e.isDirty("barcode"),required:!1})}),t.jsx("div",{className:"mt-4",children:t.jsx(_,{formProps:e,modalAction:s})}),t.jsx("div",{className:"mt-4",children:t.jsx(z,{label:"Description",value:e.data.description??void 0,onChange:o=>e.setData("description",o.target.value),disabled:s.state==="show"||e.processing,required:!1,errorMsg:e.errors.description,hideError:e.isDirty("description")})})]})}function J({modalAction:e,setModalAction:s,form:r}){const[a,i]=p.useState(!1);return t.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row-reverse",children:[e.state==="create"?t.jsxs(t.Fragment,{children:[t.jsx(f,{type:"submit",disabled:r.processing,children:"Create"}),t.jsx(x,{setModalAction:s,form:r})]}):e.state==="edit"?t.jsxs(t.Fragment,{children:[t.jsx(f,{type:"submit",disabled:r.processing,children:"Save"}),t.jsx(x,{setModalAction:s,form:r})]}):t.jsxs(t.Fragment,{children:[t.jsx(K,{setModalAction:s,form:r}),t.jsx(v,{disabled:r.processing,onClick:()=>i(!0),children:"Delete"}),t.jsx(x,{setModalAction:s,form:r})]}),t.jsx(R,{isOpen:a,requestClose:n=>{i(!1),(n==null?void 0:n.toLowerCase().trim())==="delete"&&s(d=>({...d,open:!1}))},product:r.data})]})}function K({setModalAction:e,form:s}){return t.jsx(y,{type:"button",onClick:()=>{e(r=>({data:r.data,open:!0,state:"edit"}))},disabled:s.processing,children:"Edit"})}function x({setModalAction:e,form:s}){return t.jsx(L,{type:"button",onClick:()=>{s.cancel(),e(r=>({...r,open:!1})),s.reset(),s.clearErrors()},children:"Cancel"})}function Q({modalAction:e,setModalAction:s}){const r=O(e.state==="create"?{name:"",barcode:null,description:null,imageFile:null,img:null,price:null,stock:null}:{...e.data,_method:"patch"},e.data?e.data.id.toString()+e.data.img:e.state);function a(i){i.preventDefault(),r.post(route(`product.${e.state==="edit"?"update":"store"}`,e.state==="edit"?e.data.id:void 0),{onSuccess:()=>{r.clearErrors(),r.reset(),s(()=>({state:"create",data:null,open:!1}))}})}return t.jsxs("form",{className:"mt-3",onSubmit:a,children:[t.jsx(G,{formProps:r,modalAction:e}),t.jsx(J,{modalAction:e,setModalAction:s,form:r})]})}function U({modalAction:e,setModalAction:s}){return t.jsx(W,{title:X(e.state),open:e.open,closeModal:()=>s(r=>({...r,open:!1})),children:t.jsx(Q,{modalAction:e,setModalAction:s})})}function X(e){return e==="create"?"Add New Product":e==="edit"?"Edit Product":"View Product"}function De({auth:e,products:s}){const r=s.data,[a,i]=p.useState({state:"create",open:!1,data:null});return t.jsxs(t.Fragment,{children:[t.jsx(U,{modalAction:a,setModalAction:i}),t.jsxs(P,{user:e.user,header:t.jsx($,{totalResult:s.total,requestCreateProduct:()=>i({state:"create",open:!0,data:null})}),children:[t.jsx(I,{title:"Inventory"}),t.jsxs("div",{className:"flex min-h-[75vh] flex-col justify-between",children:[t.jsxs("div",{className:"flex flex-wrap justify-center py-6",children:[r.length===0&&t.jsxs("div",{className:"my-20 flex gap-4 opacity-50",children:[t.jsx(S,{className:"mt-1"}),t.jsx("p",{children:"No products found!"})]}),r.map(n=>t.jsx(F,{product:n,requestShow:()=>i({state:"show",open:!0,data:n}),requestEdit:()=>i({state:"edit",data:n,open:!0})},n.id))]}),t.jsx(E,{paginateItems:s}),t.jsx(V,{})]})]})]})}export{De as default};
